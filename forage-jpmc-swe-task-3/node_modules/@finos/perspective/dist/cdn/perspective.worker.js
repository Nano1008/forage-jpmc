(()=>{var qs=Object.create;var St=Object.defineProperty;var Js=Object.getOwnPropertyDescriptor;var Xs=Object.getOwnPropertyNames;var Zs=Object.getPrototypeOf,Ks=Object.prototype.hasOwnProperty;var qr=h=>St(h,"__esModule",{value:!0});var Pt=(h,s)=>()=>(s||h((s={exports:{}}).exports,s),s.exports),Qs=(h,s)=>{qr(h);for(var i in s)St(h,i,{get:s[i],enumerable:!0})},eo=(h,s,i)=>{if(s&&typeof s=="object"||typeof s=="function")for(let m of Xs(s))!Ks.call(h,m)&&m!=="default"&&St(h,m,{get:()=>s[m],enumerable:!(i=Js(s,m))||i.enumerable});return h},or=h=>eo(qr(St(h!=null?qs(Zs(h)):{},"default",h&&h.__esModule&&"default"in h?{get:()=>h.default,enumerable:!0}:{value:h,enumerable:!0})),h);var ar=Pt(()=>{});var Jr=Pt(()=>{});var rn=Pt((Co,tn)=>{tn.exports.default={types:{float:{filter_operator:"==",aggregate:"sum",format:{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}},string:{filter_operator:"==",aggregate:"count"},integer:{filter_operator:"==",aggregate:"sum",format:{}},boolean:{filter_operator:"==",aggregate:"count"},datetime:{filter_operator:"==",aggregate:"count",format:{week:"numeric",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},null_value:-1},date:{filter_operator:"==",aggregate:"count",format:{week:"numeric",year:"numeric",month:"numeric",day:"numeric"},null_value:-1}}}});var jt=Pt((Ao,Pe)=>{var nn=rn().default;Pe.exports.get_types=function(){return Object.keys(Pe.exports.get_config().types)};Pe.exports.get_type_config=function(h){let s={};if(Pe.exports.get_config().types[h]&&Object.assign(s,Pe.exports.get_config().types[h]),s.type){let i=Pe.exports.get_type_config(s.type);return Object.assign(i,s),i}else return s};function ur(h){return h&&typeof h=="object"&&!Array.isArray(h)}function xt(h,...s){if(!s.length)return h;let i=s.shift();if(ur(h)&&ur(i))for(let m in i)ur(i[m])?(h[m]||Object.assign(h,{[m]:{}}),xt(h[m],i[m])):Object.assign(h,{[m]:i[m]});return xt(h,...s)}globalThis.__PERSPECTIVE_CONFIG__=void 0;Pe.exports.override_config=function(h){globalThis.__PERSPECTIVE_CONFIG__&&console.warn("Config already initialized!"),globalThis.__PERSPECTIVE_CONFIG__=xt(nn,h)};Pe.exports.get_config=function(){return globalThis.__PERSPECTIVE_CONFIG__||(globalThis.__PERSPECTIVE_CONFIG__=xt(nn,globalThis.__TEMPLATE_CONFIG__||{})),globalThis.__PERSPECTIVE_CONFIG__}});var to=(()=>{var h=typeof document!="undefined"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename!="undefined"&&(h=h||__filename),function(s){s=s||{};var i=typeof s!="undefined"?s:{},m,$;i.ready=new Promise(function(e,t){m=e,$=t});var x=Object.assign({},i),j=[],L="./this.program",J=(e,t)=>{throw t},de=typeof window=="object",k=typeof importScripts=="function",qe=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",K="";function Je(e){return i.locateFile?i.locateFile(e,K):K+e}var Me,Ue,Re,be;function G(e){if(e instanceof zr)return;Ce("exiting due to exception: "+e)}var He,Te,Xe;qe?(k?K=ar().dirname(K)+"/":K=__dirname+"/",Xe=()=>{Te||(He=Jr(),Te=ar())},Me=function(t,r){return Xe(),t=Te.normalize(t),He.readFileSync(t,r?void 0:"utf8")},Re=e=>{var t=Me(e,!0);return t.buffer||(t=new Uint8Array(t)),t},Ue=(e,t,r)=>{Xe(),e=Te.normalize(e),He.readFile(e,function(n,l){n?r(n):t(l.buffer)})},process.argv.length>1&&(L=process.argv[1].replace(/\\/g,"/")),j=process.argv.slice(2),process.on("uncaughtException",function(e){if(!(e instanceof zr))throw e}),process.on("unhandledRejection",function(e){throw e}),J=(e,t)=>{if(un())throw process.exitCode=e,t;G(t),process.exit(e)},i.inspect=function(){return"[Emscripten Module object]"}):(de||k)&&(k?K=self.location.href:typeof document!="undefined"&&document.currentScript&&(K=document.currentScript.src),h&&(K=h),K.indexOf("blob:")!==0?K=K.substr(0,K.replace(/[?#].*/,"").lastIndexOf("/")+1):K="",Me=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},k&&(Re=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),Ue=(e,t,r)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{if(n.status==200||n.status==0&&n.response){t(n.response);return}r()},n.onerror=r,n.send(null)},be=e=>document.title=e);var Ee=i.print||console.log.bind(console),Ce=i.printErr||console.warn.bind(console);Object.assign(i,x),x=null,i.arguments&&(j=i.arguments),i.thisProgram&&(L=i.thisProgram),i.quit&&(J=i.quit);var o=4,a=0,_=e=>{a=e},g;i.wasmBinary&&(g=i.wasmBinary);var y=i.noExitRuntime||!0;typeof WebAssembly!="object"&&Le("no native wasm support detected");var O,P=!1,b;function N(e,t){e||Le(t)}var S=typeof TextDecoder!="undefined"?new TextDecoder("utf8"):void 0;function z(e,t,r){t>>>=0;for(var n=t+r,l=t;e[l]&&!(l>=n);)++l;if(l-t>16&&e.buffer&&S)return S.decode(e.subarray(t,l));for(var c="";t<l;){var f=e[t++];if(!(f&128)){c+=String.fromCharCode(f);continue}var u=e[t++]&63;if((f&224)==192){c+=String.fromCharCode((f&31)<<6|u);continue}var d=e[t++]&63;if((f&240)==224?f=(f&15)<<12|u<<6|d:f=(f&7)<<18|u<<12|d<<6|e[t++]&63,f<65536)c+=String.fromCharCode(f);else{var v=f-65536;c+=String.fromCharCode(55296|v>>10,56320|v&1023)}}return c}function M(e,t){return e>>>=0,e?z(U,e,t):""}function q(e,t,r,n){if(r>>>=0,!(n>0))return 0;for(var l=r,c=r+n-1,f=0;f<e.length;++f){var u=e.charCodeAt(f);if(u>=55296&&u<=57343){var d=e.charCodeAt(++f);u=65536+((u&1023)<<10)|d&1023}if(u<=127){if(r>=c)break;t[r++>>>0]=u}else if(u<=2047){if(r+1>=c)break;t[r++>>>0]=192|u>>6,t[r++>>>0]=128|u&63}else if(u<=65535){if(r+2>=c)break;t[r++>>>0]=224|u>>12,t[r++>>>0]=128|u>>6&63,t[r++>>>0]=128|u&63}else{if(r+3>=c)break;t[r++>>>0]=240|u>>18,t[r++>>>0]=128|u>>12&63,t[r++>>>0]=128|u>>6&63,t[r++>>>0]=128|u&63}}return t[r>>>0]=0,r-l}function ce(e,t,r){return q(e,U,t,r)}function ie(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n>=55296&&n<=57343&&(n=65536+((n&1023)<<10)|e.charCodeAt(++r)&1023),n<=127?++t:n<=2047?t+=2:n<=65535?t+=3:t+=4}return t}var fe=typeof TextDecoder!="undefined"?new TextDecoder("utf-16le"):void 0;function We(e,t){for(var r=e,n=r>>1,l=n+t/2;!(n>=l)&&je[n>>>0];)++n;if(r=n<<1,r-e>32&&fe)return fe.decode(U.subarray(e>>>0,r>>>0));for(var c="",f=0;!(f>=t/2);++f){var u=he[e+f*2>>>1];if(u==0)break;c+=String.fromCharCode(u)}return c}function Dt(e,t,r){if(r===void 0&&(r=2147483647),r<2)return 0;r-=2;for(var n=t,l=r<e.length*2?r/2:e.length,c=0;c<l;++c){var f=e.charCodeAt(c);he[t>>>1]=f,t+=2}return he[t>>>1]=0,t-n}function Nt(e){return e.length*2}function oe(e,t){for(var r=0,n="";!(r>=t/4);){var l=A[e+r*4>>>2];if(l==0)break;if(++r,l>=65536){var c=l-65536;n+=String.fromCharCode(55296|c>>10,56320|c&1023)}else n+=String.fromCharCode(l)}return n}function pe(e,t,r){if(t>>>=0,r===void 0&&(r=2147483647),r<4)return 0;for(var n=t,l=n+r-4,c=0;c<e.length;++c){var f=e.charCodeAt(c);if(f>=55296&&f<=57343){var u=e.charCodeAt(++c);f=65536+((f&1023)<<10)|u&1023}if(A[t>>>2]=f,t+=4,t+4>l)break}return A[t>>>2]=0,t-n}function xe(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n>=55296&&n<=57343&&++r,t+=4}return t}function ae(e){var t=ie(e)+1,r=ct(t);return r&&q(e,Z,r,t),r}function te(e,t){Z.set(e,t>>>0)}function le(e,t,r){for(var n=0;n<e.length;++n)Z[t++>>>0]=e.charCodeAt(n);r||(Z[t>>>0]=0)}var se,Z,U,he,je,A,H,hr,Vt;function gr(e){se=e,i.HEAP8=Z=new Int8Array(e),i.HEAP16=he=new Int16Array(e),i.HEAP32=A=new Int32Array(e),i.HEAPU8=U=new Uint8Array(e),i.HEAPU16=je=new Uint16Array(e),i.HEAPU32=H=new Uint32Array(e),i.HEAPF32=hr=new Float32Array(e),i.HEAPF64=Vt=new Float64Array(e)}var go=i.INITIAL_MEMORY||16777216,vr,mr=[],yr=[],wr=[],ln=!1;function un(){return y}function cn(){if(i.preRun)for(typeof i.preRun=="function"&&(i.preRun=[i.preRun]);i.preRun.length;)dn(i.preRun.shift());Ut(mr)}function fn(){ln=!0,Ut(yr)}function _n(){if(i.postRun)for(typeof i.postRun=="function"&&(i.postRun=[i.postRun]);i.postRun.length;)hn(i.postRun.shift());Ut(wr)}function dn(e){mr.unshift(e)}function pn(e){yr.unshift(e)}function hn(e){wr.unshift(e)}var De=0,Mt=null,Ze=null;function gn(e){De++,i.monitorRunDependencies&&i.monitorRunDependencies(De)}function vn(e){if(De--,i.monitorRunDependencies&&i.monitorRunDependencies(De),De==0&&(Mt!==null&&(clearInterval(Mt),Mt=null),Ze)){var t=Ze;Ze=null,t()}}function Le(e){i.onAbort&&i.onAbort(e),e="Aborted("+e+")",Ce(e),P=!0,b=1,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw $(t),t}var mn="data:application/octet-stream;base64,";function br(e){return e.startsWith(mn)}function Tr(e){return e.startsWith("file://")}var ne;ne="perspective.cpp.wasm",br(ne)||(ne=Je(ne));function Er(e){try{if(e==ne&&g)return new Uint8Array(g);if(Re)return Re(e);throw"both async and sync fetching of the wasm failed"}catch(t){Le(t)}}function yn(){if(!g&&(de||k)){if(typeof fetch=="function"&&!Tr(ne))return fetch(ne,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+ne+"'";return e.arrayBuffer()}).catch(function(){return Er(ne)});if(Ue)return new Promise(function(e,t){Ue(ne,function(r){e(new Uint8Array(r))},t)})}return Promise.resolve().then(function(){return Er(ne)})}function wn(){var e={a:Rs};function t(f,u){var d=f.exports;i.asm=d,O=i.asm.qa,gr(O.buffer),vr=i.asm.ua,pn(i.asm.ra),vn("wasm-instantiate")}gn("wasm-instantiate");function r(f){t(f.instance)}function n(f){return yn().then(function(u){return WebAssembly.instantiate(u,e)}).then(function(u){return u}).then(f,function(u){Ce("failed to asynchronously prepare wasm: "+u),Le(u)})}function l(){return!g&&typeof WebAssembly.instantiateStreaming=="function"&&!br(ne)&&!Tr(ne)&&!qe&&typeof fetch=="function"?fetch(ne,{credentials:"same-origin"}).then(function(f){var u=WebAssembly.instantiateStreaming(f,e);return u.then(r,function(d){return Ce("wasm streaming compile failed: "+d),Ce("falling back to ArrayBuffer instantiation"),n(r)})}):n(r)}if(i.instantiateWasm)try{var c=i.instantiateWasm(e,t);return c}catch(f){return Ce("Module.instantiateWasm callback failed with error: "+f),!1}return l().catch($),{}}var bn={833364:e=>{throw new Error(M(e))}};function Ut(e){for(;e.length>0;){var t=e.shift();if(typeof t=="function"){t(i);continue}var r=t.func;typeof r=="number"?t.arg===void 0?ht(r)():ht(r)(t.arg):r(t.arg===void 0?null:t.arg)}}var pt=[];function ht(e){var t=pt[e];return t||(e>=pt.length&&(pt.length=e+1),pt[e]=t=vr.get(e)),t}function Tn(e,t,r,n){Le("Assertion failed: "+M(e)+", at: "+[t?M(t):"unknown filename",r,n?M(n):"unknown function"])}function En(e){return ct(e+24)+24}function Cn(e){this.excPtr=e,this.ptr=e-24,this.set_type=function(t){H[this.ptr+4>>>2]=t},this.get_type=function(){return H[this.ptr+4>>>2]},this.set_destructor=function(t){H[this.ptr+8>>>2]=t},this.get_destructor=function(){return H[this.ptr+8>>>2]},this.set_refcount=function(t){A[this.ptr>>>2]=t},this.set_caught=function(t){t=t?1:0,Z[this.ptr+12>>>0]=t},this.get_caught=function(){return Z[this.ptr+12>>>0]!=0},this.set_rethrown=function(t){t=t?1:0,Z[this.ptr+13>>>0]=t},this.get_rethrown=function(){return Z[this.ptr+13>>>0]!=0},this.init=function(t,r){this.set_adjusted_ptr(0),this.set_type(t),this.set_destructor(r),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var t=A[this.ptr>>>2];A[this.ptr>>>2]=t+1},this.release_ref=function(){var t=A[this.ptr>>>2];return A[this.ptr>>>2]=t-1,t===1},this.set_adjusted_ptr=function(t){H[this.ptr+16>>>2]=t},this.get_adjusted_ptr=function(){return H[this.ptr+16>>>2]},this.get_exception_ptr=function(){var t=Lr(this.get_type());if(t)return H[this.excPtr>>>2];var r=this.get_adjusted_ptr();return r!==0?r:this.excPtr}}var An=0,On=0;function Sn(e,t,r){var n=new Cn(e);throw n.init(t,r),An=e,On++,e}var Ke={varargs:void 0,get:function(){Ke.varargs+=4;var e=A[Ke.varargs-4>>>2];return e},getStr:function(e){var t=M(e);return t}};function Pn(e,t,r){return Ke.varargs=r,0}function Rn(e,t,r){}function xn(e,t,r){}function jn(e,t,r){return Ke.varargs=r,0}function kn(e,t,r,n){Ke.varargs=n}function Fn(e,t){}function $n(e,t,r){}var gt={};function Ht(e){for(;e.length;){var t=e.pop(),r=e.pop();r(t)}}function Qe(e){return this.fromWireType(H[e>>>2])}var ze={},Ne={},vt={},In=48,Dn=57;function mt(e){if(e===void 0)return"_unknown";e=e.replace(/[^a-zA-Z0-9_]/g,"$");var t=e.charCodeAt(0);return t>=In&&t<=Dn?"_"+e:e}function yt(e,t){return e=mt(e),new Function("body","return function "+e+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(t)}function Wt(e,t){var r=yt(t,function(n){this.name=t,this.message=n;var l=new Error(n).stack;l!==void 0&&(this.stack=this.toString()+`
`+l.replace(/^Error(:[^\n]*)?\n/,""))});return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},r}var Cr=void 0;function wt(e){throw new Cr(e)}function ke(e,t,r){e.forEach(function(u){vt[u]=t});function n(u){var d=r(u);d.length!==e.length&&wt("Mismatched type converter count");for(var v=0;v<e.length;++v)ge(e[v],d[v])}var l=new Array(t.length),c=[],f=0;t.forEach((u,d)=>{Ne.hasOwnProperty(u)?l[d]=Ne[u]:(c.push(u),ze.hasOwnProperty(u)||(ze[u]=[]),ze[u].push(()=>{l[d]=Ne[u],++f,f===c.length&&n(l)}))}),c.length===0&&n(l)}function Nn(e){var t=gt[e];delete gt[e];var r=t.rawConstructor,n=t.rawDestructor,l=t.fields,c=l.map(f=>f.getterReturnType).concat(l.map(f=>f.setterArgumentType));ke([e],c,f=>{var u={};return l.forEach((d,v)=>{var C=d.fieldName,E=f[v],T=d.getter,D=d.getterContext,W=f[v+l.length],Y=d.setter,Q=d.setterContext;u[C]={read:R=>E.fromWireType(T(D,R)),write:(R,p)=>{var w=[];Y(Q,R,W.toWireType(w,p)),Ht(w)}}}),[{name:t.name,fromWireType:function(d){var v={};for(var C in u)v[C]=u[C].read(d);return n(d),v},toWireType:function(d,v){for(var C in u)if(!(C in v))throw new TypeError('Missing field:  "'+C+'"');var E=r();for(C in u)u[C].write(E,v[C]);return d!==null&&d.push(n,E),E},argPackAdvance:8,readValueFromPointer:Qe,destructorFunction:n}]})}function Vn(e,t,r,n,l){}function bt(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}function Mn(){for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);Ar=e}var Ar=void 0;function X(e){for(var t="",r=e;U[r>>>0];)t+=Ar[U[r++>>>0]];return t}var Ye=void 0;function I(e){throw new Ye(e)}function ge(e,t,r={}){if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var n=t.name;if(e||I('type "'+n+'" must have a positive integer typeid pointer'),Ne.hasOwnProperty(e)){if(r.ignoreDuplicateRegistrations)return;I("Cannot register type '"+n+"' twice")}if(Ne[e]=t,delete vt[e],ze.hasOwnProperty(e)){var l=ze[e];delete ze[e],l.forEach(c=>c())}}function Un(e,t,r,n,l){var c=bt(r);t=X(t),ge(e,{name:t,fromWireType:function(f){return!!f},toWireType:function(f,u){return u?n:l},argPackAdvance:8,readValueFromPointer:function(f){var u;if(r===1)u=Z;else if(r===2)u=he;else if(r===4)u=A;else throw new TypeError("Unknown boolean type size: "+t);return this.fromWireType(u[f>>>c])},destructorFunction:null})}function Hn(e){if(!(this instanceof Fe)||!(e instanceof Fe))return!1;for(var t=this.$$.ptrType.registeredClass,r=this.$$.ptr,n=e.$$.ptrType.registeredClass,l=e.$$.ptr;t.baseClass;)r=t.upcast(r),t=t.baseClass;for(;n.baseClass;)l=n.upcast(l),n=n.baseClass;return t===n&&r===l}function Wn(e){return{count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType}}function Lt(e){function t(r){return r.$$.ptrType.registeredClass.name}I(t(e)+" instance already deleted")}var zt=!1;function Or(e){}function Ln(e){e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)}function Sr(e){e.count.value-=1;var t=e.count.value===0;t&&Ln(e)}function Pr(e,t,r){if(t===r)return e;if(r.baseClass===void 0)return null;var n=Pr(e,t,r.baseClass);return n===null?null:r.downcast(n)}var Rr={};function zn(){return Object.keys(rt).length}function Yn(){var e=[];for(var t in rt)rt.hasOwnProperty(t)&&e.push(rt[t]);return e}var et=[];function Yt(){for(;et.length;){var e=et.pop();e.$$.deleteScheduled=!1,e.delete()}}var tt=void 0;function Gn(e){tt=e,et.length&&tt&&tt(Yt)}function Bn(){i.getInheritedInstanceCount=zn,i.getLiveInheritedInstances=Yn,i.flushPendingDeletes=Yt,i.setDelayFunction=Gn}var rt={};function qn(e,t){for(t===void 0&&I("ptr should not be undefined");e.baseClass;)t=e.upcast(t),e=e.baseClass;return t}function Jn(e,t){return t=qn(e,t),rt[t]}function Tt(e,t){(!t.ptrType||!t.ptr)&&wt("makeClassHandle requires ptr and ptrType");var r=!!t.smartPtrType,n=!!t.smartPtr;return r!==n&&wt("Both smartPtrType and smartPtr must be specified"),t.count={value:1},nt(Object.create(e,{$$:{value:t}}))}function Xn(e){var t=this.getPointee(e);if(!t)return this.destructor(e),null;var r=Jn(this.registeredClass,t);if(r!==void 0){if(r.$$.count.value===0)return r.$$.ptr=t,r.$$.smartPtr=e,r.clone();var n=r.clone();return this.destructor(e),n}function l(){return this.isSmartPointer?Tt(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:t,smartPtrType:this,smartPtr:e}):Tt(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var c=this.registeredClass.getActualType(t),f=Rr[c];if(!f)return l.call(this);var u;this.isConst?u=f.constPointerType:u=f.pointerType;var d=Pr(t,this.registeredClass,u.registeredClass);return d===null?l.call(this):this.isSmartPointer?Tt(u.registeredClass.instancePrototype,{ptrType:u,ptr:d,smartPtrType:this,smartPtr:e}):Tt(u.registeredClass.instancePrototype,{ptrType:u,ptr:d})}function nt(e){return typeof FinalizationRegistry=="undefined"?(nt=t=>t,e):(zt=new FinalizationRegistry(t=>{Sr(t.$$)}),nt=t=>{var r=t.$$,n=!!r.smartPtr;if(n){var l={$$:r};zt.register(t,l,t)}return t},Or=t=>zt.unregister(t),nt(e))}function Zn(){if(this.$$.ptr||Lt(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e=nt(Object.create(Object.getPrototypeOf(this),{$$:{value:Wn(this.$$)}}));return e.$$.count.value+=1,e.$$.deleteScheduled=!1,e}function Kn(){this.$$.ptr||Lt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&I("Object already scheduled for deletion"),Or(this),Sr(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Qn(){return!this.$$.ptr}function ei(){return this.$$.ptr||Lt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&I("Object already scheduled for deletion"),et.push(this),et.length===1&&tt&&tt(Yt),this.$$.deleteScheduled=!0,this}function ti(){Fe.prototype.isAliasOf=Hn,Fe.prototype.clone=Zn,Fe.prototype.delete=Kn,Fe.prototype.isDeleted=Qn,Fe.prototype.deleteLater=ei}function Fe(){}function xr(e,t,r){if(e[t].overloadTable===void 0){var n=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||I("Function '"+r+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[t].overloadTable+")!"),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[n.argCount]=n}}function Gt(e,t,r){i.hasOwnProperty(e)?((r===void 0||i[e].overloadTable!==void 0&&i[e].overloadTable[r]!==void 0)&&I("Cannot register public name '"+e+"' twice"),xr(i,e,e),i.hasOwnProperty(r)&&I("Cannot register multiple overloads of a function with the same number of arguments ("+r+")!"),i[e].overloadTable[r]=t):(i[e]=t,r!==void 0&&(i[e].numArguments=r))}function ri(e,t,r,n,l,c,f,u){this.name=e,this.constructor=t,this.instancePrototype=r,this.rawDestructor=n,this.baseClass=l,this.getActualType=c,this.upcast=f,this.downcast=u,this.pureVirtualFunctions=[]}function Bt(e,t,r){for(;t!==r;)t.upcast||I("Expected null or instance of "+r.name+", got an instance of "+t.name),e=t.upcast(e),t=t.baseClass;return e}function ni(e,t){if(t===null)return this.isReference&&I("null is not a valid "+this.name),0;t.$$||I('Cannot pass "'+Kt(t)+'" as a '+this.name),t.$$.ptr||I("Cannot pass deleted object as a pointer of type "+this.name);var r=t.$$.ptrType.registeredClass,n=Bt(t.$$.ptr,r,this.registeredClass);return n}function ii(e,t){var r;if(t===null)return this.isReference&&I("null is not a valid "+this.name),this.isSmartPointer?(r=this.rawConstructor(),e!==null&&e.push(this.rawDestructor,r),r):0;t.$$||I('Cannot pass "'+Kt(t)+'" as a '+this.name),t.$$.ptr||I("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&t.$$.ptrType.isConst&&I("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);var n=t.$$.ptrType.registeredClass;if(r=Bt(t.$$.ptr,n,this.registeredClass),this.isSmartPointer)switch(t.$$.smartPtr===void 0&&I("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:t.$$.smartPtrType===this?r=t.$$.smartPtr:I("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:r=t.$$.smartPtr;break;case 2:if(t.$$.smartPtrType===this)r=t.$$.smartPtr;else{var l=t.clone();r=this.rawShare(r,V.toHandle(function(){l.delete()})),e!==null&&e.push(this.rawDestructor,r)}break;default:I("Unsupporting sharing policy")}return r}function si(e,t){if(t===null)return this.isReference&&I("null is not a valid "+this.name),0;t.$$||I('Cannot pass "'+Kt(t)+'" as a '+this.name),t.$$.ptr||I("Cannot pass deleted object as a pointer of type "+this.name),t.$$.ptrType.isConst&&I("Cannot convert argument of type "+t.$$.ptrType.name+" to parameter type "+this.name);var r=t.$$.ptrType.registeredClass,n=Bt(t.$$.ptr,r,this.registeredClass);return n}function oi(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e}function ai(e){this.rawDestructor&&this.rawDestructor(e)}function li(e){e!==null&&e.delete()}function ui(){ve.prototype.getPointee=oi,ve.prototype.destructor=ai,ve.prototype.argPackAdvance=8,ve.prototype.readValueFromPointer=Qe,ve.prototype.deleteObject=li,ve.prototype.fromWireType=Xn}function ve(e,t,r,n,l,c,f,u,d,v,C){this.name=e,this.registeredClass=t,this.isReference=r,this.isConst=n,this.isSmartPointer=l,this.pointeeType=c,this.sharingPolicy=f,this.rawGetPointee=u,this.rawConstructor=d,this.rawShare=v,this.rawDestructor=C,!l&&t.baseClass===void 0?n?(this.toWireType=ni,this.destructorFunction=null):(this.toWireType=si,this.destructorFunction=null):this.toWireType=ii}function jr(e,t,r){i.hasOwnProperty(e)||wt("Replacing nonexistant public symbol"),i[e].overloadTable!==void 0&&r!==void 0?i[e].overloadTable[r]=t:(i[e]=t,i[e].argCount=r)}function ci(e,t,r){var n=i["dynCall_"+e];return r&&r.length?n.apply(null,[t].concat(r)):n.call(null,t)}function fi(e,t,r){return e.includes("j")?ci(e,t,r):ht(t).apply(null,r)}function _i(e,t){var r=[];return function(){return r.length=0,Object.assign(r,arguments),fi(e,t,r)}}function re(e,t){e=X(e);function r(){return e.includes("j")?_i(e,t):ht(t)}var n=r();return typeof n!="function"&&I("unknown function pointer with signature "+e+": "+t),n}var kr=void 0;function Fr(e){var t=Wr(e),r=X(t);return Ae(t),r}function Et(e,t){var r=[],n={};function l(c){if(!n[c]&&!Ne[c]){if(vt[c]){vt[c].forEach(l);return}r.push(c),n[c]=!0}}throw t.forEach(l),new kr(e+": "+r.map(Fr).join([", "]))}function di(e,t,r,n,l,c,f,u,d,v,C,E,T){C=X(C),c=re(l,c),u&&(u=re(f,u)),v&&(v=re(d,v)),T=re(E,T);var D=mt(C);Gt(D,function(){Et("Cannot construct "+C+" due to unbound types",[n])}),ke([e,t,r],n?[n]:[],function(W){W=W[0];var Y,Q;n?(Y=W.registeredClass,Q=Y.instancePrototype):Q=Fe.prototype;var R=yt(D,function(){if(Object.getPrototypeOf(this)!==p)throw new Ye("Use 'new' to construct "+C);if(w.constructor_body===void 0)throw new Ye(C+" has no accessible constructor");var Ve=w.constructor_body[arguments.length];if(Ve===void 0)throw new Ye("Tried to invoke ctor of "+C+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(w.constructor_body).toString()+") parameters instead!");return Ve.apply(this,arguments)}),p=Object.create(Q,{constructor:{value:R}});R.prototype=p;var w=new ri(C,R,p,T,Y,c,u,v),ee=new ve(C,w,!0,!1,!1),B=new ve(C+"*",w,!1,!1,!1),me=new ve(C+" const*",w,!1,!0,!1);return Rr[e]={pointerType:B,constPointerType:me},jr(D,R),[ee,B,me]})}function qt(e,t){for(var r=[],n=0;n<e;n++)r.push(A[(t>>2)+n>>>0]);return r}function $r(e,t){if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+typeof e+" which is not a function");var r=yt(e.name||"unknownFunctionName",function(){});r.prototype=e.prototype;var n=new r,l=e.apply(n,t);return l instanceof Object?l:n}function Jt(e,t,r,n,l){var c=t.length;c<2&&I("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var f=t[1]!==null&&r!==null,u=!1,d=1;d<t.length;++d)if(t[d]!==null&&t[d].destructorFunction===void 0){u=!0;break}for(var v=t[0].name!=="void",C="",E="",d=0;d<c-2;++d)C+=(d!==0?", ":"")+"arg"+d,E+=(d!==0?", ":"")+"arg"+d+"Wired";var T="return function "+mt(e)+"("+C+`) {
if (arguments.length !== `+(c-2)+`) {
throwBindingError('function `+e+" called with ' + arguments.length + ' arguments, expected "+(c-2)+` args!');
}
`;u&&(T+=`var destructors = [];
`);var D=u?"destructors":"null",W=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],Y=[I,n,l,Ht,t[0],t[1]];f&&(T+="var thisWired = classParam.toWireType("+D+`, this);
`);for(var d=0;d<c-2;++d)T+="var arg"+d+"Wired = argType"+d+".toWireType("+D+", arg"+d+"); // "+t[d+2].name+`
`,W.push("argType"+d),Y.push(t[d+2]);if(f&&(E="thisWired"+(E.length>0?", ":"")+E),T+=(v?"var rv = ":"")+"invoker(fn"+(E.length>0?", ":"")+E+`);
`,u)T+=`runDestructors(destructors);
`;else for(var d=f?1:2;d<t.length;++d){var Q=d===1?"thisWired":"arg"+(d-2)+"Wired";t[d].destructorFunction!==null&&(T+=Q+"_dtor("+Q+"); // "+t[d].name+`
`,W.push(Q+"_dtor"),Y.push(t[d].destructorFunction))}v&&(T+=`var ret = retType.fromWireType(rv);
return ret;
`),T+=`}
`,W.push(T);var R=$r(Function,W).apply(null,Y);return R}function pi(e,t,r,n,l,c){N(t>0);var f=qt(t,r);l=re(n,l),ke([],[e],function(u){u=u[0];var d="constructor "+u.name;if(u.registeredClass.constructor_body===void 0&&(u.registeredClass.constructor_body=[]),u.registeredClass.constructor_body[t-1]!==void 0)throw new Ye("Cannot register multiple constructors with identical number of parameters ("+(t-1)+") for class '"+u.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return u.registeredClass.constructor_body[t-1]=()=>{Et("Cannot construct "+u.name+" due to unbound types",f)},ke([],f,function(v){return v.splice(1,0,null),u.registeredClass.constructor_body[t-1]=Jt(d,v,null,l,c),[]}),[]})}function hi(e,t,r,n,l,c,f,u){var d=qt(r,n);t=X(t),c=re(l,c),ke([],[e],function(v){v=v[0];var C=v.name+"."+t;t.startsWith("@@")&&(t=Symbol[t.substring(2)]),u&&v.registeredClass.pureVirtualFunctions.push(t);function E(){Et("Cannot call "+C+" due to unbound types",d)}var T=v.registeredClass.instancePrototype,D=T[t];return D===void 0||D.overloadTable===void 0&&D.className!==v.name&&D.argCount===r-2?(E.argCount=r-2,E.className=v.name,T[t]=E):(xr(T,t,C),T[t].overloadTable[r-2]=E),ke([],d,function(W){var Y=Jt(C,W,v,c,f);return T[t].overloadTable===void 0?(Y.argCount=r-2,T[t]=Y):T[t].overloadTable[r-2]=Y,[]}),[]})}var Xt=[],_e=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Zt(e){e>4&&--_e[e].refcount==0&&(_e[e]=void 0,Xt.push(e))}function gi(){for(var e=0,t=5;t<_e.length;++t)_e[t]!==void 0&&++e;return e}function vi(){for(var e=5;e<_e.length;++e)if(_e[e]!==void 0)return _e[e];return null}function mi(){i.count_emval_handles=gi,i.get_first_emval=vi}var V={toValue:e=>(e||I("Cannot use deleted val. handle = "+e),_e[e].value),toHandle:e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var t=Xt.length?Xt.pop():_e.length;return _e[t]={refcount:1,value:e},t}}}};function yi(e,t){t=X(t),ge(e,{name:t,fromWireType:function(r){var n=V.toValue(r);return Zt(r),n},toWireType:function(r,n){return V.toHandle(n)},argPackAdvance:8,readValueFromPointer:Qe,destructorFunction:null})}function wi(e,t,r){switch(t){case 0:return function(n){var l=r?Z:U;return this.fromWireType(l[n>>>0])};case 1:return function(n){var l=r?he:je;return this.fromWireType(l[n>>>1])};case 2:return function(n){var l=r?A:H;return this.fromWireType(l[n>>>2])};default:throw new TypeError("Unknown integer type: "+e)}}function bi(e,t,r,n){var l=bt(r);t=X(t);function c(){}c.values={},ge(e,{name:t,constructor:c,fromWireType:function(f){return this.constructor.values[f]},toWireType:function(f,u){return u.value},argPackAdvance:8,readValueFromPointer:wi(t,l,n),destructorFunction:null}),Gt(t,c)}function it(e,t){var r=Ne[e];return r===void 0&&I(t+" has unknown type "+Fr(e)),r}function Ti(e,t,r){var n=it(e,"enum");t=X(t);var l=n.constructor,c=Object.create(n.constructor.prototype,{value:{value:r},constructor:{value:yt(n.name+"_"+t,function(){})}});l.values[r]=c,l[t]=c}function Kt(e){if(e===null)return"null";var t=typeof e;return t==="object"||t==="array"||t==="function"?e.toString():""+e}function Ei(e,t){switch(t){case 2:return function(r){return this.fromWireType(hr[r>>>2])};case 3:return function(r){return this.fromWireType(Vt[r>>>3])};default:throw new TypeError("Unknown float type: "+e)}}function Ci(e,t,r){var n=bt(r);t=X(t),ge(e,{name:t,fromWireType:function(l){return l},toWireType:function(l,c){return c},argPackAdvance:8,readValueFromPointer:Ei(t,n),destructorFunction:null})}function Ai(e,t,r,n,l,c){var f=qt(t,r);e=X(e),l=re(n,l),Gt(e,function(){Et("Cannot call "+e+" due to unbound types",f)},t-1),ke([],f,function(u){var d=[u[0],null].concat(u.slice(1));return jr(e,Jt(e,d,null,l,c),t-1),[]})}function Oi(e,t,r){switch(t){case 0:return r?function(l){return Z[l>>>0]}:function(l){return U[l>>>0]};case 1:return r?function(l){return he[l>>>1]}:function(l){return je[l>>>1]};case 2:return r?function(l){return A[l>>>2]}:function(l){return H[l>>>2]};default:throw new TypeError("Unknown integer type: "+e)}}function Si(e,t,r,n,l){t=X(t),l===-1&&(l=4294967295);var c=bt(r),f=E=>E;if(n===0){var u=32-8*r;f=E=>E<<u>>>u}var d=t.includes("unsigned"),v=(E,T)=>{},C;d?C=function(E,T){return v(T,this.name),T>>>0}:C=function(E,T){return v(T,this.name),T},ge(e,{name:t,fromWireType:f,toWireType:C,argPackAdvance:8,readValueFromPointer:Oi(t,c,n!==0),destructorFunction:null})}function Pi(e,t,r){var n=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],l=n[t];function c(f){f=f>>2;var u=H,d=u[f>>>0],v=u[f+1>>>0];return new l(se,v,d)}r=X(r),ge(e,{name:r,fromWireType:c,argPackAdvance:8,readValueFromPointer:c},{ignoreDuplicateRegistrations:!0})}function Ri(e,t,r,n,l,c,f,u,d,v,C,E){r=X(r),c=re(l,c),u=re(f,u),v=re(d,v),E=re(C,E),ke([e],[t],function(T){T=T[0];var D=new ve(r,T.registeredClass,!1,!1,!0,T,n,c,u,v,E);return[D]})}function xi(e,t){t=X(t);var r=t==="std::string";ge(e,{name:t,fromWireType:function(n){var l=H[n>>>2],c;if(r)for(var f=n+4,u=0;u<=l;++u){var d=n+4+u;if(u==l||U[d>>>0]==0){var v=d-f,C=M(f,v);c===void 0?c=C:(c+=String.fromCharCode(0),c+=C),f=d+1}}else{for(var E=new Array(l),u=0;u<l;++u)E[u]=String.fromCharCode(U[n+4+u>>>0]);c=E.join("")}return Ae(n),c},toWireType:function(n,l){l instanceof ArrayBuffer&&(l=new Uint8Array(l));var c,f=typeof l=="string";f||l instanceof Uint8Array||l instanceof Uint8ClampedArray||l instanceof Int8Array||I("Cannot pass non-string to std::string"),r&&f?c=()=>ie(l):c=()=>l.length;var u=c(),d=ct(4+u+1);if(d>>>=0,H[d>>>2]=u,r&&f)ce(l,d+4,u+1);else if(f)for(var v=0;v<u;++v){var C=l.charCodeAt(v);C>255&&(Ae(d),I("String has UTF-16 code units that do not fit in 8 bits")),U[d+4+v>>>0]=C}else for(var v=0;v<u;++v)U[d+4+v>>>0]=l[v];return n!==null&&n.push(Ae,d),d},argPackAdvance:8,readValueFromPointer:Qe,destructorFunction:function(n){Ae(n)}})}function ji(e,t,r){r=X(r);var n,l,c,f,u;t===2?(n=We,l=Dt,f=Nt,c=()=>je,u=1):t===4&&(n=oe,l=pe,f=xe,c=()=>H,u=2),ge(e,{name:r,fromWireType:function(d){for(var v=H[d>>>2],C=c(),E,T=d+4,D=0;D<=v;++D){var W=d+4+D*t;if(D==v||C[W>>>u]==0){var Y=W-T,Q=n(T,Y);E===void 0?E=Q:(E+=String.fromCharCode(0),E+=Q),T=W+t}}return Ae(d),E},toWireType:function(d,v){typeof v!="string"&&I("Cannot pass non-string to C++ string type "+r);var C=f(v),E=ct(4+C+t);return E>>>=0,H[E>>>2]=C>>u,l(v,E+4,C+t),d!==null&&d.push(Ae,E),E},argPackAdvance:8,readValueFromPointer:Qe,destructorFunction:function(d){Ae(d)}})}function ki(e,t,r,n,l,c){gt[e]={name:X(t),rawConstructor:re(r,n),rawDestructor:re(l,c),fields:[]}}function Fi(e,t,r,n,l,c,f,u,d,v){gt[e].fields.push({fieldName:X(t),getterReturnType:r,getter:re(n,l),getterContext:c,setterArgumentType:f,setter:re(u,d),setterContext:v})}function $i(e,t){t=X(t),ge(e,{isVoid:!0,name:t,argPackAdvance:0,fromWireType:function(){},toWireType:function(r,n){}})}function Ii(){return Date.now()}var Di=!0;function Ni(){return Di}function Vi(e,t,r){e=V.toValue(e),t=it(t,"emval::as");var n=[],l=V.toHandle(n);return A[r>>>2]=l,t.toWireType(n,e)}function Ir(e,t){for(var r=new Array(e),n=0;n<e;++n)r[n]=it(H[t+n*o>>>2],"parameter "+n);return r}function Mi(e,t,r,n){e=V.toValue(e);for(var l=Ir(t,r),c=new Array(t),f=0;f<t;++f){var u=l[f];c[f]=u.readValueFromPointer(n),n+=u.argPackAdvance}var d=e.apply(void 0,c);return V.toHandle(d)}function Ui(e){var t=[];return A[e>>>2]=V.toHandle(t),t}var Hi={};function st(e){var t=Hi[e];return t===void 0?X(e):t}var Ct=[];function Wi(e,t,r,n,l){return e=Ct[e],t=V.toValue(t),r=st(r),e(t,r,Ui(n),l)}function Li(e,t,r,n){e=Ct[e],t=V.toValue(t),r=st(r),e(t,r,null,n)}function Dr(){return typeof globalThis=="object"?globalThis:function(){return Function}()("return this")()}function zi(e){return e===0?V.toHandle(Dr()):(e=st(e),V.toHandle(Dr()[e]))}function Yi(e){var t=Ct.length;return Ct.push(e),t}var Nr=[];function Gi(e,t){var r=Ir(e,t),n=r[0],l=n.name+"_$"+r.slice(1).map(function(W){return W.name}).join("_")+"$",c=Nr[l];if(c!==void 0)return c;for(var f=["retType"],u=[n],d="",v=0;v<e-1;++v)d+=(v!==0?", ":"")+"arg"+v,f.push("argType"+v),u.push(r[1+v]);for(var C=mt("methodCaller_"+l),E="return function "+C+`(handle, name, destructors, args) {
`,T=0,v=0;v<e-1;++v)E+="    var arg"+v+" = argType"+v+".readValueFromPointer(args"+(T?"+"+T:"")+`);
`,T+=r[v+1].argPackAdvance;E+="    var rv = handle[name]("+d+`);
`;for(var v=0;v<e-1;++v)r[v+1].deleteObject&&(E+="    argType"+v+".deleteObject(arg"+v+`);
`);n.isVoid||(E+=`    return retType.toWireType(destructors, rv);
`),E+=`};
`,f.push(E);var D=$r(Function,f).apply(null,u);return c=Yi(D),Nr[l]=c,c}function Bi(e){return e=st(e),V.toHandle(i[e])}function qi(e,t){return e=V.toValue(e),t=V.toValue(t),V.toHandle(e[t])}function Ji(e){e>4&&(_e[e].refcount+=1)}function Xi(e,t){return e=V.toValue(e),t=V.toValue(t),e instanceof t}function Zi(e){for(var t="",r=0;r<e;++r)t+=(r!==0?", ":"")+"arg"+r;for(var n="return function emval_allocator_"+e+`(constructor, argTypes, args) {
`,r=0;r<e;++r)n+="var argType"+r+" = requireRegisteredType(Module['HEAP32'][(argTypes >>> 2) + "+r+'], "parameter '+r+`");
var arg`+r+" = argType"+r+`.readValueFromPointer(args);
args += argType`+r+`['argPackAdvance'];
`;return n+="var obj = new constructor("+t+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle",n)(it,i,V.toHandle)}var Vr={};function Ki(e,t,r,n){e=V.toValue(e);var l=Vr[t];return l||(l=Zi(t),Vr[t]=l),l(e,r,n)}function Qi(){return V.toHandle([])}function es(e){return V.toHandle(st(e))}function ts(){return V.toHandle({})}function rs(e){var t=V.toValue(e);Ht(t),Zt(e)}function ns(e,t,r){e=V.toValue(e),t=V.toValue(t),r=V.toValue(r),e[t]=r}function is(e,t){e=it(e,"_emval_take_value");var r=e.readValueFromPointer(t);return V.toHandle(r)}function ss(e){return e=V.toValue(e),V.toHandle(typeof e)}function os(e,t){var r=new Date(A[e>>>2]*1e3);A[t>>>2]=r.getSeconds(),A[t+4>>>2]=r.getMinutes(),A[t+8>>>2]=r.getHours(),A[t+12>>>2]=r.getDate(),A[t+16>>>2]=r.getMonth(),A[t+20>>>2]=r.getFullYear()-1900,A[t+24>>>2]=r.getDay();var n=new Date(r.getFullYear(),0,1),l=(r.getTime()-n.getTime())/(1e3*60*60*24)|0;A[t+28>>>2]=l,A[t+36>>>2]=-(r.getTimezoneOffset()*60);var c=new Date(r.getFullYear(),6,1).getTimezoneOffset(),f=n.getTimezoneOffset(),u=(c!=f&&r.getTimezoneOffset()==Math.min(f,c))|0;A[t+32>>>2]=u}function as(e,t,r,n,l,c){return-52}function ls(e,t,r,n,l,c){e>>>=0}function us(e,t,r){var n=new Date().getFullYear(),l=new Date(n,0,1),c=new Date(n,6,1),f=l.getTimezoneOffset(),u=c.getTimezoneOffset(),d=Math.max(f,u);A[e>>>2]=d*60,A[t>>>2]=Number(f!=u);function v(W){var Y=W.toTimeString().match(/\(([A-Za-z ]+)\)$/);return Y?Y[1]:"GMT"}var C=v(l),E=v(c),T=ae(C),D=ae(E);u<f?(H[r>>>2]=T,H[r+4>>>2]=D):(H[r>>>2]=D,H[r+4>>>2]=T)}function Qt(e,t,r){Qt.called||(Qt.called=!0,us(e,t,r))}function cs(){Le("")}var er=[];function fs(e,t){er.length=0;var r;for(t>>=2;r=U[e++>>>0];)t+=r!=105&t,er.push(r==105?A[t>>>0]:Vt[t++>>>1]),++t;return er}function _s(e,t,r){var n=fs(t,r);return bn[e].apply(null,n)}function Mr(){return 4294901760}function ds(){return Mr()}var tr;qe?tr=()=>{var e=process.hrtime();return e[0]*1e3+e[1]/1e6}:tr=()=>performance.now();function ps(e,t,r){U.copyWithin(e>>>0,t>>>0,t+r>>>0)}function hs(e){try{return O.grow(e-se.byteLength+65535>>>16),gr(O.buffer),1}catch{}}function gs(e){var t=U.length;e=e>>>0;var r=Mr();if(e>r)return!1;let n=(d,v)=>d+(v-d%v)%v;for(var l=1;l<=4;l*=2){var c=t*(1+.2/l);c=Math.min(c,e+100663296);var f=Math.min(r,n(Math.max(e,c),65536)),u=hs(f);if(u)return!0}return!1}var rr={};function vs(){return L||"./this.program"}function ot(){if(!ot.strings){var e=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:vs()};for(var r in rr)rr[r]===void 0?delete t[r]:t[r]=rr[r];var n=[];for(var r in t)n.push(r+"="+t[r]);ot.strings=n}return ot.strings}function ms(e,t){var r=0;return ot().forEach(function(n,l){var c=t+r;H[e+l*4>>>2]=c,le(n,c),r+=n.length+1}),0}function ys(e,t){var r=ot();H[e>>>2]=r.length;var n=0;return r.forEach(function(l){n+=l.length+1}),H[t>>>2]=n,0}function ws(e){return 52}function bs(e,t,r,n){return 52}function Ts(e,t,r,n,l){return 70}var Es=[null,[],[]];function Cs(e,t){var r=Es[e];t===0||t===10?((e===1?Ee:Ce)(z(r,0)),r.length=0):r.push(t)}function As(e,t,r,n){for(var l=0,c=0;c<r;c++){var f=H[t>>>2],u=H[t+4>>>2];t+=8;for(var d=0;d<u;d++)Cs(e,U[f+d>>>0]);l+=u}return H[n>>>2]=l,0}function Os(e){_(e)}function Ge(e){return e%4==0&&(e%100!=0||e%400==0)}function nr(e,t){for(var r=0,n=0;n<=t;r+=e[n++]);return r}var at=[31,29,31,30,31,30,31,31,30,31,30,31],lt=[31,28,31,30,31,30,31,31,30,31,30,31];function ut(e,t){for(var r=new Date(e.getTime());t>0;){var n=Ge(r.getFullYear()),l=r.getMonth(),c=(n?at:lt)[l];if(t>c-r.getDate())t-=c-r.getDate()+1,r.setDate(1),l<11?r.setMonth(l+1):(r.setMonth(0),r.setFullYear(r.getFullYear()+1));else return r.setDate(r.getDate()+t),r}return r}function Ur(e,t,r,n){var l=A[n+40>>>2],c={tm_sec:A[n>>>2],tm_min:A[n+4>>>2],tm_hour:A[n+8>>>2],tm_mday:A[n+12>>>2],tm_mon:A[n+16>>>2],tm_year:A[n+20>>>2],tm_wday:A[n+24>>>2],tm_yday:A[n+28>>>2],tm_isdst:A[n+32>>>2],tm_gmtoff:A[n+36>>>2],tm_zone:l?M(l):""},f=M(r),u={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var d in u)f=f.replace(new RegExp(d,"g"),u[d]);var v=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],C=["January","February","March","April","May","June","July","August","September","October","November","December"];function E(p,w,ee){for(var B=typeof p=="number"?p.toString():p||"";B.length<w;)B=ee[0]+B;return B}function T(p,w){return E(p,w,"0")}function D(p,w){function ee(me){return me<0?-1:me>0?1:0}var B;return(B=ee(p.getFullYear()-w.getFullYear()))===0&&(B=ee(p.getMonth()-w.getMonth()))===0&&(B=ee(p.getDate()-w.getDate())),B}function W(p){switch(p.getDay()){case 0:return new Date(p.getFullYear()-1,11,29);case 1:return p;case 2:return new Date(p.getFullYear(),0,3);case 3:return new Date(p.getFullYear(),0,2);case 4:return new Date(p.getFullYear(),0,1);case 5:return new Date(p.getFullYear()-1,11,31);case 6:return new Date(p.getFullYear()-1,11,30)}}function Y(p){var w=ut(new Date(p.tm_year+1900,0,1),p.tm_yday),ee=new Date(w.getFullYear(),0,4),B=new Date(w.getFullYear()+1,0,4),me=W(ee),Ve=W(B);return D(me,w)<=0?D(Ve,w)<=0?w.getFullYear()+1:w.getFullYear():w.getFullYear()-1}var Q={"%a":function(p){return v[p.tm_wday].substring(0,3)},"%A":function(p){return v[p.tm_wday]},"%b":function(p){return C[p.tm_mon].substring(0,3)},"%B":function(p){return C[p.tm_mon]},"%C":function(p){var w=p.tm_year+1900;return T(w/100|0,2)},"%d":function(p){return T(p.tm_mday,2)},"%e":function(p){return E(p.tm_mday,2," ")},"%g":function(p){return Y(p).toString().substring(2)},"%G":function(p){return Y(p)},"%H":function(p){return T(p.tm_hour,2)},"%I":function(p){var w=p.tm_hour;return w==0?w=12:w>12&&(w-=12),T(w,2)},"%j":function(p){return T(p.tm_mday+nr(Ge(p.tm_year+1900)?at:lt,p.tm_mon-1),3)},"%m":function(p){return T(p.tm_mon+1,2)},"%M":function(p){return T(p.tm_min,2)},"%n":function(){return`
`},"%p":function(p){return p.tm_hour>=0&&p.tm_hour<12?"AM":"PM"},"%S":function(p){return T(p.tm_sec,2)},"%t":function(){return"	"},"%u":function(p){return p.tm_wday||7},"%U":function(p){var w=p.tm_yday+7-p.tm_wday;return T(Math.floor(w/7),2)},"%V":function(p){var w=Math.floor((p.tm_yday+7-(p.tm_wday+6)%7)/7);if((p.tm_wday+371-p.tm_yday-2)%7<=2&&w++,w){if(w==53){var B=(p.tm_wday+371-p.tm_yday)%7;B!=4&&(B!=3||!Ge(p.tm_year))&&(w=1)}}else{w=52;var ee=(p.tm_wday+7-p.tm_yday-1)%7;(ee==4||ee==5&&Ge(p.tm_year%400-1))&&w++}return T(w,2)},"%w":function(p){return p.tm_wday},"%W":function(p){var w=p.tm_yday+7-(p.tm_wday+6)%7;return T(Math.floor(w/7),2)},"%y":function(p){return(p.tm_year+1900).toString().substring(2)},"%Y":function(p){return p.tm_year+1900},"%z":function(p){var w=p.tm_gmtoff,ee=w>=0;return w=Math.abs(w)/60,w=w/60*100+w%60,(ee?"+":"-")+String("0000"+w).slice(-4)},"%Z":function(p){return p.tm_zone},"%%":function(){return"%"}};f=f.replace(/%%/g,"\0\0");for(var d in Q)f.includes(d)&&(f=f.replace(new RegExp(d,"g"),Q[d](c)));f=f.replace(/\0\0/g,"%");var R=Hr(f,!1);return R.length>t?0:(te(R,e),R.length-1)}function Ss(e,t,r,n){return Ur(e,t,r,n)}function ue(e){return parseInt(e)}function Ps(e,t,r){for(var n=M(t),l="\\!@#$^&*()+=-[]/{}|:<>?,.",c=0,f=l.length;c<f;++c)n=n.replace(new RegExp("\\"+l[c],"g"),"\\"+l[c]);var u={"%A":"%a","%B":"%b","%c":"%a %b %d %H:%M:%S %Y","%D":"%m\\/%d\\/%y","%e":"%d","%F":"%Y-%m-%d","%h":"%b","%R":"%H\\:%M","%r":"%I\\:%M\\:%S\\s%p","%T":"%H\\:%M\\:%S","%x":"%m\\/%d\\/(?:%y|%Y)","%X":"%H\\:%M\\:%S"};for(var d in u)n=n.replace(d,u[d]);var v={"%a":"(?:Sun(?:day)?)|(?:Mon(?:day)?)|(?:Tue(?:sday)?)|(?:Wed(?:nesday)?)|(?:Thu(?:rsday)?)|(?:Fri(?:day)?)|(?:Sat(?:urday)?)","%b":"(?:Jan(?:uary)?)|(?:Feb(?:ruary)?)|(?:Mar(?:ch)?)|(?:Apr(?:il)?)|May|(?:Jun(?:e)?)|(?:Jul(?:y)?)|(?:Aug(?:ust)?)|(?:Sep(?:tember)?)|(?:Oct(?:ober)?)|(?:Nov(?:ember)?)|(?:Dec(?:ember)?)","%C":"\\d\\d","%d":"0[1-9]|[1-9](?!\\d)|1\\d|2\\d|30|31","%H":"\\d(?!\\d)|[0,1]\\d|20|21|22|23","%I":"\\d(?!\\d)|0\\d|10|11|12","%j":"00[1-9]|0?[1-9](?!\\d)|0?[1-9]\\d(?!\\d)|[1,2]\\d\\d|3[0-6]\\d","%m":"0[1-9]|[1-9](?!\\d)|10|11|12","%M":"0\\d|\\d(?!\\d)|[1-5]\\d","%n":"\\s","%p":"AM|am|PM|pm|A\\.M\\.|a\\.m\\.|P\\.M\\.|p\\.m\\.","%S":"0\\d|\\d(?!\\d)|[1-5]\\d|60","%U":"0\\d|\\d(?!\\d)|[1-4]\\d|50|51|52|53","%W":"0\\d|\\d(?!\\d)|[1-4]\\d|50|51|52|53","%w":"[0-6]","%y":"\\d\\d","%Y":"\\d\\d\\d\\d","%%":"%","%t":"\\s"},C={JAN:0,FEB:1,MAR:2,APR:3,MAY:4,JUN:5,JUL:6,AUG:7,SEP:8,OCT:9,NOV:10,DEC:11},E={SUN:0,MON:1,TUE:2,WED:3,THU:4,FRI:5,SAT:6},T={MON:0,TUE:1,WED:2,THU:3,FRI:4,SAT:5,SUN:6};for(var D in v)n=n.replace(D,"("+D+v[D]+")");for(var W=[],c=n.indexOf("%");c>=0;c=n.indexOf("%"))W.push(n[c+1]),n=n.replace(new RegExp("\\%"+n[c+1],"g"),"");var Y=new RegExp("^"+n,"i").exec(M(e));function Q(){function $e(Ie,sr,Br){return typeof Ie!="number"||isNaN(Ie)?sr:Ie>=sr?Ie<=Br?Ie:Br:sr}return{year:$e(A[r+20>>>2]+1900,1970,9999),month:$e(A[r+16>>>2],0,11),day:$e(A[r+12>>>2],1,31),hour:$e(A[r+8>>>2],0,23),min:$e(A[r+4>>>2],0,59),sec:$e(A[r>>>2],0,59)}}if(Y){var R=Q(),p,w=$e=>{var Ie=W.indexOf($e);if(Ie>=0)return Y[Ie+1]};if((p=w("S"))&&(R.sec=ue(p)),(p=w("M"))&&(R.min=ue(p)),p=w("H"))R.hour=ue(p);else if(p=w("I")){var ee=ue(p);(p=w("p"))&&(ee+=p.toUpperCase()[0]==="P"?12:0),R.hour=ee}if(p=w("Y"))R.year=ue(p);else if(p=w("y")){var B=ue(p);(p=w("C"))?B+=ue(p)*100:B+=B<69?2e3:1900,R.year=B}if((p=w("m"))?R.month=ue(p)-1:(p=w("b"))&&(R.month=C[p.substring(0,3).toUpperCase()]||0),p=w("d"))R.day=ue(p);else if(p=w("j"))for(var me=ue(p),Ve=Ge(R.year),Ot=0;Ot<12;++Ot){var Yr=nr(Ve?at:lt,Ot-1);me<=Yr+(Ve?at:lt)[Ot]&&(R.day=me-Yr)}else if(p=w("a")){var Gr=p.substring(0,3).toUpperCase();if(p=w("U")){var ft=E[Gr],_t=ue(p),Oe=new Date(R.year,0,1),Se;Oe.getDay()===0?Se=ut(Oe,ft+7*(_t-1)):Se=ut(Oe,7-Oe.getDay()+ft+7*(_t-1)),R.day=Se.getDate(),R.month=Se.getMonth()}else if(p=w("W")){var ft=T[Gr],_t=ue(p),Oe=new Date(R.year,0,1),Se;Oe.getDay()===1?Se=ut(Oe,ft+7*(_t-1)):Se=ut(Oe,7-Oe.getDay()+1+ft+7*(_t-1)),R.day=Se.getDate(),R.month=Se.getMonth()}}var ye=new Date(R.year,R.month,R.day,R.hour,R.min,R.sec,0);return A[r>>>2]=ye.getSeconds(),A[r+4>>>2]=ye.getMinutes(),A[r+8>>>2]=ye.getHours(),A[r+12>>>2]=ye.getDate(),A[r+16>>>2]=ye.getMonth(),A[r+20>>>2]=ye.getFullYear()-1900,A[r+24>>>2]=ye.getDay(),A[r+28>>>2]=nr(Ge(ye.getFullYear())?at:lt,ye.getMonth()-1)+ye.getDate()-1,A[r+32>>>2]=0,e+Hr(Y[0]).length-1}return 0}Cr=i.InternalError=Wt(Error,"InternalError"),Mn(),Ye=i.BindingError=Wt(Error,"BindingError"),ti(),Bn(),ui(),kr=i.UnboundTypeError=Wt(Error,"UnboundTypeError"),mi();function Hr(e,t,r){var n=r>0?r:ie(e)+1,l=new Array(n),c=q(e,l,0,l.length);return t&&(l.length=c),l}var Rs={a:Tn,i:En,h:Sn,M:Pn,T:Rn,X:xn,da:jn,N:kn,aa:Fn,V:$n,F:Nn,U:Vn,la:Un,q:di,v:pi,d:hi,ka:yi,Q:bi,u:Ti,O:Ci,p:Ai,B:Si,x:Pi,y:Ri,P:xi,J:ji,G:ki,A:Fi,ma:$i,ga:Ii,fa:Ni,l:Vi,pa:Mi,o:Wi,r:Li,b:Zt,s:zi,k:Gi,w:Bi,m:qi,e:Ji,R:Xi,t:Ki,H:Qi,n:es,L:ts,g:rs,C:ns,j:is,D:ss,ha:os,Y:as,Z:ls,ia:Qt,f:cs,c:_s,W:ds,ea:tr,ja:ps,I:gs,_:ms,$:ys,E:ws,ca:bs,S:Ts,ba:As,K:Os,oa:Ur,z:Ss,na:Ps},vo=wn(),xs=i.___wasm_call_ctors=function(){return(xs=i.___wasm_call_ctors=i.asm.ra).apply(null,arguments)},ct=i._malloc=function(){return(ct=i._malloc=i.asm.sa).apply(null,arguments)},Ae=i._free=function(){return(Ae=i._free=i.asm.ta).apply(null,arguments)},Wr=i.___getTypeName=function(){return(Wr=i.___getTypeName=i.asm.va).apply(null,arguments)},js=i.___embind_register_native_and_builtin_types=function(){return(js=i.___embind_register_native_and_builtin_types=i.asm.wa).apply(null,arguments)},Lr=i.___cxa_is_pointer_type=function(){return(Lr=i.___cxa_is_pointer_type=i.asm.xa).apply(null,arguments)},ks=i.dynCall_ji=function(){return(ks=i.dynCall_ji=i.asm.ya).apply(null,arguments)},Fs=i.dynCall_viij=function(){return(Fs=i.dynCall_viij=i.asm.za).apply(null,arguments)},$s=i.dynCall_viiij=function(){return($s=i.dynCall_viiij=i.asm.Aa).apply(null,arguments)},Is=i.dynCall_viiijj=function(){return(Is=i.dynCall_viiijj=i.asm.Ba).apply(null,arguments)},Ds=i.dynCall_viji=function(){return(Ds=i.dynCall_viji=i.asm.Ca).apply(null,arguments)},Ns=i.dynCall_viiji=function(){return(Ns=i.dynCall_viiji=i.asm.Da).apply(null,arguments)},Vs=i.dynCall_viijji=function(){return(Vs=i.dynCall_viijji=i.asm.Ea).apply(null,arguments)},Ms=i.dynCall_viijj=function(){return(Ms=i.dynCall_viijj=i.asm.Fa).apply(null,arguments)},Us=i.dynCall_viijij=function(){return(Us=i.dynCall_viijij=i.asm.Ga).apply(null,arguments)},Hs=i.dynCall_viiiijii=function(){return(Hs=i.dynCall_viiiijii=i.asm.Ha).apply(null,arguments)},Ws=i.dynCall_vijjji=function(){return(Ws=i.dynCall_vijjji=i.asm.Ia).apply(null,arguments)},Ls=i.dynCall_jiji=function(){return(Ls=i.dynCall_jiji=i.asm.Ja).apply(null,arguments)},zs=i.dynCall_viijii=function(){return(zs=i.dynCall_viijii=i.asm.Ka).apply(null,arguments)},Ys=i.dynCall_iiiiij=function(){return(Ys=i.dynCall_iiiiij=i.asm.La).apply(null,arguments)},Gs=i.dynCall_iiiiijj=function(){return(Gs=i.dynCall_iiiiijj=i.asm.Ma).apply(null,arguments)},Bs=i.dynCall_iiiiiijj=function(){return(Bs=i.dynCall_iiiiiijj=i.asm.Na).apply(null,arguments)},At;function zr(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}Ze=function e(){At||ir(),At||(Ze=e)};function ir(e){if(e=e||j,De>0||(cn(),De>0))return;function t(){At||(At=!0,i.calledRun=!0,!P&&(fn(),m(i),i.onRuntimeInitialized&&i.onRuntimeInitialized(),_n()))}i.setStatus?(i.setStatus("Running..."),setTimeout(function(){setTimeout(function(){i.setStatus("")},1),t()},1)):t()}if(i.run=ir,i.preInit)for(typeof i.preInit=="function"&&(i.preInit=[i.preInit]);i.preInit.length>0;)i.preInit.pop()();return ir(),s.ready}})(),Xr=to;var Rt={};Qs(Rt,{COLUMN_SEPARATOR_STRING:()=>we,CONFIG_ALIASES:()=>dt,CONFIG_VALID_KEYS:()=>Zr,DATA_TYPES:()=>ro,FILTER_OPERATORS:()=>F,SORT_ORDERS:()=>io,SORT_ORDER_IDS:()=>so,TYPE_AGGREGATES:()=>oo,TYPE_FILTERS:()=>uo});var ro={integer:"integer",float:"float",string:"string",boolean:"boolean",date:"date",datetime:"datetime",object:"object"},dt={row_pivot:"group_by","row-pivot":"group_by","row-pivots":"group_by",col_pivot:"split_by",col_pivots:"split_by",column_pivot:"split_by","column-pivot":"split_by","column-pivots":"split_by",filters:"filter",sorts:"sort"},Zr=["viewport","group_by","split_by","aggregates","columns","filter","sort","computed_columns","expressions","group_by_depth","split_by_depth","filter_op"],Kr=["any","avg","abs sum","count","distinct count","dominant","first by index","last by index","last minus first","last","high","join","low","high minus low","mean","median","pct sum parent","pct sum grand total","stddev","sum","sum abs","sum not null","unique","var"],lr=["any","count","distinct count","distinct leaf","dominant","first by index","join","last by index","last","unique"],no=["any","count","distinct count","distinct leaf","dominant","first by index","last by index","last","unique"],io=["none","asc","desc","col asc","col desc","asc abs","desc abs","col asc abs","col desc abs"],so=[2,0,1,0,1,3,4,3,4],oo={string:lr,float:Kr,integer:Kr,boolean:no,datetime:lr,date:lr},F={lessThan:"<",greaterThan:">",equals:"==",lessThanOrEquals:"<=",greaterThanOrEquals:">=",doesNotEqual:"!=",isNull:"is null",isNotNull:"is not null",isIn:"in",isNotIn:"not in",contains:"contains",bitwiseAnd:"&",bitwiseOr:"|",and:"and",or:"or",beginsWith:"begins with",endsWith:"ends with"},ao=[F.bitwiseAnd,F.bitwiseOr,F.equals,F.doesNotEqual,F.or,F.and,F.isNull,F.isNotNull],Qr=[F.lessThan,F.greaterThan,F.equals,F.lessThanOrEquals,F.greaterThanOrEquals,F.doesNotEqual,F.isNull,F.isNotNull],lo=[F.equals,F.contains,F.doesNotEqual,F.isIn,F.isNotIn,F.beginsWith,F.endsWith,F.isNull,F.isNotNull],en=[F.lessThan,F.greaterThan,F.equals,F.lessThanOrEquals,F.greaterThanOrEquals,F.doesNotEqual,F.isNull,F.isNotNull],we="|",uo={string:lo,float:Qr,integer:Qr,boolean:ao,datetime:en,date:en};var $t=or(jt());function kt(h){if(h>=1&&h<=8)return"integer";if(h===19)return"string";if(h===10||h===9)return"float";if(h===11)return"boolean";if(h===12)return"datetime";if(h===13)return"date";console.warn(`Unknown type for value ${h} with JS type ${typeof h}`)}function cr(h){let s=h;do for(let i of Object.getOwnPropertyNames(s)){let m=h[i];i!=="constructor"&&typeof m=="function"&&(h[i]=m.bind(h))}while(s=s!==Object&&Object.getPrototypeOf(s))}String.prototype.includes||(String.prototype.includes=function(h,s){return typeof s!="number"&&(s=0),s+h.length>this.length?!1:this.indexOf(h,s)!==-1});Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(h,s){if(this==null)throw new TypeError('"this" is null or not defined');var i=Object(this),m=i.length>>>0;if(m===0)return!1;var $=s|0,x=Math.max($>=0?$:m-Math.abs($),0);function j(L,J){return L===J||typeof L=="number"&&typeof J=="number"&&isNaN(L)&&isNaN(J)}for(;x<m;){if(j(i[x],h))return!0;x++}return!1}});var sn=or(jt()),fr=class{constructor(){this.data_formats={row:0,column:1,schema:2},this.format=void 0,this.data=void 0,this.names=void 0,this.types=void 0,this.row_count=void 0}is_format(s){if(Array.isArray(s))return this.data_formats.row;if(Array.isArray(s[Object.keys(s)[0]]))return this.data_formats.column;if(typeof s[Object.keys(s)[0]]=="string"||typeof s[Object.keys(s)[0]]=="function")return this.data_formats.schema;throw`Could not determine data format for ${JSON.stringify(s)}, with JS typeof ${typeof s}`}count_rows(s){return this.format===this.data_formats.row?s.length:this.format===this.data_formats.column?s[Object.keys(s)[0]].length:0}get_format(){return this.format}get(s,i){let m;if(this.format===this.data_formats.row){let $=this.data[i];$.hasOwnProperty(s)&&(m=$[s])}else if(this.format===this.data_formats.column)this.data.hasOwnProperty(s)&&(m=this.data[s][i]);else if(this.format===this.data_formats.schema)m=void 0;else throw`Could not get() from dataset - ${this.data} is poorly formatted.`;return m}marshal(s,i,m){let $=this.names[s],x=co(this.get($,i));if(x===null)return null;if(typeof x!="undefined"){switch(kt(m.value)){case"float":case"integer":{x=Number(x);break}case"boolean":{typeof x=="string"?x.toLowerCase()==="true"?x=!0:x=!1:x=!!x;break}case"datetime":case"date":break;default:x+=""}return x}}clean(){this.names=void 0,this.types=void 0}init(s){this.data=s,this.format=this.is_format(this.data),this.row_count=this.count_rows(this.data);let i={};if(this.format===this.data_formats.row)s.length>0?this.names=Object.keys(s[0]):this.clean.names=[];else if(this.format===this.data_formats.column)this.names=Object.keys(s);else if(this.format===this.data_formats.schema){this.names=Object.keys(s);for(let m of this.names){let $=(0,sn.get_type_config)(s[m]);$.type&&(console.debug(`Converting "${s[m]}" to "${$.type}"`),i[m]=s[m],s[m]=$.type)}}else throw`Could not initialize - failed to determine format for ${s}`;return i}};function co(h){return h===null||h==="null"?null:h===void 0||h==="undefined"?void 0:h}var _r=function(h){let s=[];for(let i=0;i<h.size();i++){let m=h.get(i);s.push(m)}return h.delete(),s},dr=function(h){let s={},i=h.keys();for(let m=0;m<i.size();m++){let $=i.get(m);s[$]=h.get($)}return h.delete(),i.delete(),s},Be=function(h,s){for(let i of s)h.push_back(i);return h};var on=or(jt());function fo(h){let s={};return typeof h!="string"?Object.getOwnPropertyNames(h).forEach(i=>{s[i]=h[i]},h):s.message=h,s}var Ft=class{constructor(s){this.perspective=s,this._tables={},this._views={},this._callback_cache=new Map}init(s){s.config&&(0,on.override_config)(s.config),s.data=["wait_for_response"],this.post(s)}post(s){throw new Error(`Posting ${s} failed - post() not implemented!`)}process(s,i){switch(s.cmd){case"init_profile_thread":this.perspective.initialize_profile_thread();break;case"memory_usage":this.post({id:s.id,data:this.perspective.memory_usage()});break;case"init":this.init(s);break;case"table":if(typeof s.args[0]=="undefined")this._tables[s.name]=[];else try{let j=this._tables[s.name],L=this.perspective.table(s.args[0],s.options);if(L&&L.then)L.then(J=>{if(this._tables[s.name]=J,j)for(let de of j)this.process(de);this.post({id:s.id,data:s.name})}).catch(J=>this.process_error(s,J));else{if(this._tables[s.name]=L,j)for(let J of j)this.process(J);this.post({id:s.id,data:s.name})}}catch(j){this.process_error(s,j);return}break;case"table_generate":(0,eval)(s.args)(function(j){this._tables[s.name]=j,this.post({id:s.id,data:"created!"})});break;case"table_execute":(0,eval)(s.f)(this._tables[s.name]);break;case"table_method":case"view_method":this.process_method_call(s);break;case"view":let x=this._tables[s.table_name];if(x&&Array.isArray(x))x.push(s),this._views[s.view_name]=[];else try{let j=this._views[s.view_name],L=this._tables[s.table_name].view(s.config);if(L&&L.then)L.then(J=>{if(this._views[s.view_name]=J,this._views[s.view_name].client_id=i,j)for(let de of j)this.process(de);this.post({id:s.id,data:s.view_name})}).catch(J=>this.process_error(s,J));else{if(this._views[s.view_name]=L,this._views[s.view_name].client_id=i,j)for(let J of j)this.process(J);this.post({id:s.id,data:s.view_name})}}catch(j){this.process_error(s,j);return}break}}process_subscribe(s,i){try{let m;s.method.slice(0,2)==="on"?(m=$=>{let x={id:s.id,data:$};try{if(s.args&&s.args[0]&&s.method==="on_update"&&s.args[0].mode==="row"){this.post(x,[$.delta]);return}this.post(x)}catch{console.error(`Removing failed callback to \`${s.method}()\` (presumably due to failed connection)`);let L=s.method.substring(3);i[`remove_${L}`](m)}},s.callback_id&&this._callback_cache.set(s.callback_id,m)):s.callback_id&&(m=this._callback_cache.get(s.callback_id),this._callback_cache.delete(s.callback_id)),m?i[s.method](m,...s.args):console.error(`Callback not found for remote call "${JSON.stringify(s)}"`)}catch(m){this.process_error(s,m);return}}process_method_call(s){let i,m,$=s.view_name||s.name;if(s.cmd==="table_method"?i=this._tables[$]:i=this._views[$],!i&&s.cmd==="view_method"){this.process_error(s,{message:"View method cancelled"});return}if(i&&i.push){i.push(s);return}try{if(s.subscribe){this.process_subscribe(s,i);return}else m=i[s.method].apply(i,s.args),m instanceof Promise?m.then(x=>this.process_method_call_response(s,x)).catch(x=>this.process_error(s,x)):this.process_method_call_response(s,m)}catch(x){this.process_error(s,x);return}}process_method_call_response(s,i){s.method==="delete"&&delete this._views[s.name],s.method==="to_arrow"?this.post({id:s.id,data:i},[i]):this.post({id:s.id,data:i})}process_error(s,i){this.post({id:s.id,error:fo(i)})}clear_views(s){for(let i of Object.keys(this._views))if(this._views[i].client_id===s){try{this._views[i].delete()}catch(m){console.error(m)}delete this._views[i]}console.debug(`GC ${Object.keys(this._views).length} views in memory`)}};var _o={initDataValue:()=>[],initRowValue:()=>({}),initColumnValue:(h,s,i)=>s[i]=[],setColumnValue:(h,s,i,m)=>s[i]=m,addColumnValue:(h,s,i,m)=>s[i].unshift(m),addRow:(h,s)=>h.push(s),formatData:h=>h,slice:(h,s)=>h.slice(s)},po={initDataValue:()=>new Object,initRowValue:()=>{},setColumnValue:(h,s,i,m)=>{h[i]=h[i]||[],h[i].push(m)},addColumnValue:(h,s,i,m)=>{h[i]=h[i]||[],h[i][h[i].length-1].unshift(m)},initColumnValue:(h,s,i)=>{h[i]=h[i]||[],h[i].push([])},addRow:()=>{},formatData:h=>h,slice:(h,s)=>{let i={};for(let m in h)i[m]=h[m].slice(s);return i}},pr={jsonFormatter:_o,jsonTableFormatter:po};typeof self!="undefined"&&self.performance===void 0&&(self.performance={now:Date.now});var It=new Set;function an(h){let s=h,i=new fr,m=["zero","one","two"],$={};function x(o,a){$[a]?o.delete():($[a]=o,setTimeout(()=>j(a)))}function j(o){let a=$[o];a&&(a._process(),L(o))}function L(o){$[o]?.delete(),delete $[o]}function J(){let o=performance.memory?JSON.parse(JSON.stringify(performance.memory,["totalJSHeapSize","usedJSHeapSize","jsHeapSizeLimit"])):process.memoryUsage();return o.wasmHeap=s.HEAP8.length,o}function de(o,a,_,g,y,O,P,b,N){_||(_=""),g||(g=4294967295),a=s.make_table(a,o,g,_,y,O,P,b,N);let S=a.get_pool(),z=a.get_id();return O||y==s.t_op.OP_DELETE?x(S,z):(S._process(),S.delete()),a}function k(o,a,_,g,y){this.name=y,this._View=void 0,this.table=o,this.config=_||{},this.view_config=g||new g,this.is_unit_context=this.table.index===""&&a===0&&this.view_config.group_by.length===0&&this.view_config.split_by.length===0&&this.view_config.filter.length===0&&this.view_config.sort.length===0&&this.view_config.expressions.length===0,this.is_unit_context?this._View=s.make_view_unit(o._Table,y,we,this.view_config,null):a===0?this._View=s.make_view_zero(o._Table,y,we,this.view_config,null):a===1?this._View=s.make_view_one(o._Table,y,we,this.view_config,null):a===2&&(this._View=s.make_view_two(o._Table,y,we,this.view_config,null)),this.ctx=this._View.get_context(),this.column_only=this._View.is_column_only(),this.update_callbacks=this.table.update_callbacks,this.overridden_types=this.table.overridden_types,this._delete_callbacks=[],cr(this)}k.prototype.get_config=function(){return JSON.parse(JSON.stringify(this.config))},k.prototype.delete=function(){L(this.table.get_id()),this._View.delete(),this.ctx.delete(),this.table.views.splice(this.table.views.indexOf(this),1),this.table=void 0;let o=0,a=0;for(;o<this.update_callbacks.length;){let _=this.update_callbacks[o];_.view!==this&&(this.update_callbacks[a++]=_),o++}this.update_callbacks.length=a,this._delete_callbacks.forEach(_=>_())},k.prototype.sides=function(){return this._View.sides()},k.prototype._num_hidden=function(){let o=0;for(let a of this.config.sort)this.config.columns.indexOf(a[0])===-1&&o++;return o};function qe(o){let a=[];for(let _=0;_<o.size();_++){let g=o.get(_);a.push(s.scalar_to_val(g,!1,!0)),g.delete()}return o.delete(),a}let K=function(o){let a=[];for(let _=0;_<o.size();_++){let g=o.get(_);a.push(qe(g))}return o.delete(),a};k.prototype.schema=function(o=!0){let a=dr(this._View.schema());if(o)for(let _ of Object.keys(a)){let g=_.split(we);g=g[g.length-1],this.overridden_types[g]&&(0,$t.get_type_config)(this.overridden_types[g]).type===a[_]&&(a[_]=this.overridden_types[g])}return a},k.prototype.expression_schema=function(o=!0){let a=dr(this._View.expression_schema());if(o)for(let _ of Object.keys(a)){let g=_.split(we);g=g[g.length-1],this.overridden_types[g]&&(0,$t.get_type_config)(this.overridden_types[g]).type===a[_]&&(a[_]=this.overridden_types[g])}return a},k.prototype._column_names=function(o=!1,a=0){return K(this._View.column_names(o,a)).map(_=>_.join(we))},k.prototype.column_paths=function(){return K(this._View.column_paths()).map(o=>o.join(we))},k.prototype.get_data_slice=function(o,a,_,g){if(this.is_unit_context)return s.get_data_slice_unit(this._View,o,a,_,g);{let y=this.sides(),O=m[y];return s[`get_data_slice_${O}`](this._View,o,a,_,g)}};let Je=function(o){o=o||{};let a=this._View.num_columns()+(this.sides()===0?0:1),_=this._View.num_rows(),g=this._num_hidden(),y=this.sides()>0||this.column_only?1:0,O=this.config.viewport?this.config.viewport:{},P=o.start_row||(O.top?O.top:0),b=Math.min(_,o.end_row!==void 0?o.end_row:O.height?P+O.height:_),N=o.start_col||(O.left?O.left:0),S=Math.min(a,(o.end_col!==void 0?o.end_col+y:O.width?N+O.width:a)*(g+1));return o.start_row=Math.floor(P),o.end_row=Math.ceil(b),o.start_col=Math.floor(N),o.end_col=Math.ceil(S),o};k.prototype.get_min_max=function(o){if(this.is_unit_context)return s.get_min_max_unit(this._View,o);{let a=this.sides(),_=m[a];return s[`get_min_max_${_}`](this._View,o)}};let Me=function(o,a){j(this.table.get_id()),o=Je.bind(this)(o);let _=o.start_row,g=o.end_row,y=o.start_col,O=o.end_col,P=this._num_hidden(),b=o.formatted,N=!!o.index,S=!!o.id,z=!!o.leaves_only,M=this.sides(),q=M!==0&&!this.column_only,ce=m[M],ie;this.is_unit_context?ie=s.get_from_data_slice_unit:ie=s[`get_from_data_slice_${ce}`];let fe=this.get_data_slice(_,g,y,O),We=fe.get_column_names(),Dt=K(We).map(pe=>pe.join(we)),Nt=this.schema(),oe=a.initDataValue();for(let pe=_;pe<g;pe++){let xe=q?fe.get_row_path(pe):void 0;if(q&&z&&xe.size()<this.config.group_by.length){xe.delete();continue}let ae=a.initRowValue();S&&a.initColumnValue(oe,ae,"__ID__");for(let te=y;te<O;te++){let le=Dt[te],se=Nt[le],Z=(0,$t.get_type_config)(se);if(te===y&&M!==0){if(!this.column_only){a.initColumnValue(oe,ae,"__ROW_PATH__");for(let U=0;U<xe.size();U++){let he=xe.get(U),je=s.scalar_to_val(he,!1,!1);he.delete(),a.addColumnValue(oe,ae,"__ROW_PATH__",je),S&&a.addColumnValue(oe,ae,"__ID__",je)}}}else{if((te-(M>0?1:0))%(this.config.columns.length+P)>=this.config.columns.length)continue;{let U=ie(fe,pe,te);b&&U!==null&&U!==void 0&&(se==="datetime"||se==="date")&&(U=new Date(U),U=U.toLocaleString("en-us",Z.format)),a.setColumnValue(oe,ae,le,U)}}}if(N){let te=fe.get_pkeys(pe,0);a.initColumnValue(oe,ae,"__INDEX__");for(let le=0;le<te.size();le++){let se=te.get(le),Z=s.scalar_to_val(se,!1,!1);se.delete(),a.addColumnValue(oe,ae,"__INDEX__",Z)}te.delete()}if(S&&M===0){let te=fe.get_pkeys(pe,0);for(let le=0;le<te.size();le++){let se=te.get(le),Z=s.scalar_to_val(se,!1,!1);se.delete(),a.addColumnValue(oe,ae,"__ID__",Z)}te.delete()}xe&&xe.delete(),a.addRow(oe,ae)}return fe.delete(),a.formatData(oe,o.config)},Ue=function(o,a,_){let g=this.num_rows(),y=a.start_row||0,O=a.end_row||g,b=this._column_names().indexOf(o);if(b===-1)return;this.sides()>0&&b++;let S,z;a.data_slice?S=a.data_slice.get_column_slice(b):(z=this.get_data_slice(y,O,b,b+1),S=z.get_slice());let M=this._View.get_column_dtype(b),q=_(S,M,b);return S.delete(),z&&z.delete(),q};k.prototype.to_columns=function(o){return Me.call(this,o,pr.jsonTableFormatter)},k.prototype.to_json=function(o){return Me.call(this,o,pr.jsonFormatter)},k.prototype.to_csv=function(o){j(this.table.get_id()),o=Je.bind(this)(o);let a=o.start_row,_=o.end_row,g=o.start_col,y=o.end_col,O=this.sides();if(this.is_unit_context)return s.to_csv_unit(this._View,a,_,g,y);if(O===0)return s.to_csv_zero(this._View,a,_,g,y);if(O===1)return s.to_csv_one(this._View,a,_,g,y);if(O===2)return s.to_csv_two(this._View,a,_,g,y)},k.prototype.col_to_js_typed_array=function(o,a={}){j(this.table.get_id());let _=s.col_to_js_typed_array;return Ue.call(this,o,a,_)},k.prototype.to_arrow=function(o={}){j(this.table.get_id()),o=Je.bind(this)(o);let a=o.start_row,_=o.end_row,g=o.start_col,y=o.end_col,O=this.sides();if(this.is_unit_context)return s.to_arrow_unit(this._View,a,_,g,y);if(O===0)return s.to_arrow_zero(this._View,a,_,g,y);if(O===1)return s.to_arrow_one(this._View,a,_,g,y);if(O===2)return s.to_arrow_two(this._View,a,_,g,y)},k.prototype.num_rows=function(){return j(this.table.get_id()),this._View.num_rows()},k.prototype.num_columns=function(){let o=this._View.num_columns(),a=this._num_hidden();return o-o/(this.config.columns.length+a)*a},k.prototype.get_row_expanded=function(o){return this._View.get_row_expanded(o)},k.prototype.expand=function(o){return this._View.expand(o,this.config.group_by.length)},k.prototype.collapse=function(o){return this._View.collapse(o)},k.prototype.set_depth=function(o){return this._View.set_depth(o,this.config.group_by.length)},k.prototype._get_step_delta=async function(){let o=this._View.get_step_delta(0,2147483647),a;if(o.cells.size()===0)a=this.to_json();else{let _={};for(let y=0;y<o.cells.size();y++)_[o.cells.get(y).row]=!0;_=Object.keys(_);let g=_.map(y=>this.to_json({start_row:Number.parseInt(y),end_row:Number.parseInt(y)+1}));a=[].concat.apply([],g)}return o.cells.delete(),a},k.prototype._get_row_delta=async function(){if(this.is_unit_context)return s.get_row_delta_unit(this._View);{let o=this.sides(),a=m[o];return s[`get_row_delta_${a}`](this._View)}},k.prototype.on_update=function(o,{mode:a="none"}={}){if(j(this.table.get_id()),["none","row"].indexOf(a)===-1)throw new Error(`Invalid update mode "${a}" - valid modes are "none" and "row".`);a==="row"&&(this._View._get_deltas_enabled()||this._View._set_deltas_enabled(!0)),this.update_callbacks.push({view:this,orig_callback:o,callback:async(_,g)=>{g[_]===void 0&&(g[_]={});let y={port_id:_};a==="row"&&(g[_].row_delta===void 0&&(g[_].row_delta=await this._get_row_delta()),y.delta=g[_].row_delta),o(y)}})};function Re(o,a){let _=0,g=0;for(;_<o.length;){let y=o[_];a(y,_,o)&&(o[g++]=y),_++}return o.length=g,o}k.prototype.remove_update=function(o){j(this.table.get_id());let a=this.update_callbacks.length;Re(this.update_callbacks,_=>_.orig_callback!==o),console.assert(a>this.update_callbacks.length,'"callback" does not match a registered updater')},k.prototype.on_delete=function(o){this._delete_callbacks.push(o)},k.prototype.remove_delete=function(o){let a=this._delete_callbacks.length;Re(this._delete_callbacks,_=>_!==o),console.assert(a>this._delete_callbacks.length,'"callback" does not match a registered delete callbacks')};function be(o){this.group_by=o.group_by||[],this.split_by=o.split_by||[],this.aggregates=o.aggregates||{},this.columns=o.columns,this.filter=o.filter||[],this.sort=o.sort||[],this.expressions=o.expressions||[],this.filter_op=o.filter_op||"and",this.group_by_depth=o.group_by_depth,this.split_by_depth=o.split_by_depth}be.prototype.get_group_by=function(){let o=s.make_string_vector();return Be(o,this.group_by)},be.prototype.get_split_by=function(){let o=s.make_string_vector();return Be(o,this.split_by)},be.prototype.get_columns=function(){let o=s.make_string_vector();return Be(o,this.columns)},be.prototype.get_filter=function(){let o=s.make_2d_val_vector();for(let a of this.filter){let _=s.make_val_vector(),g=Be(_,a);o.push_back(g)}return o},be.prototype.get_sort=function(){let o=s.make_2d_string_vector();for(let a of this.sort){let _=s.make_string_vector(),g=Be(_,a);o.push_back(g)}return o},be.prototype.get_expressions=function(){let o=s.make_2d_val_vector();for(let a of this.expressions){let _=s.make_val_vector();for(let g of a)_.push_back(g);o.push_back(_)}return o};function G(o,a,_,g){this._Table=o;let y=this._Table.get_gnode();this.gnode_id=y.get_id(),y.delete();let O=this._Table.get_pool();O.set_update_delegate(this),O.delete(),this.name=Math.random()+"",this.initialized=!1,this.index=a,this.limit=_,this.update_callbacks=[],this._delete_callbacks=[],this.views=[],this.overridden_types=g,cr(this)}G.prototype.get_id=function(){return this._Table.get_id()},G.prototype.get_pool=function(){return this._Table.get_pool()},G.prototype.make_port=function(){return this._Table.make_port()},G.prototype.remove_port=function(){this._Table.remove_port()},G.prototype._update_callback=function(o){let a={};for(let _ in this.update_callbacks)this.update_callbacks[_].callback(o,a)},G.prototype.get_index=function(){return this.index},G.prototype.get_limit=function(){return this.limit},G.prototype.clear=function(){L(this.get_id()),this._Table.reset_gnode(this.gnode_id)},G.prototype.replace=function(o){L(this.get_id()),this._Table.reset_gnode(this.gnode_id),this.update(o),j(this.get_id())},G.prototype.delete=function(){if(this.views.length>0)throw`Cannot delete Table as it still has ${this.views.length} registered View(s).`;L(this.get_id()),this._Table.unregister_gnode(this.gnode_id),this._Table.delete();for(let o of this._delete_callbacks)o()},G.prototype.on_delete=function(o){this._delete_callbacks.push(o)},G.prototype.remove_delete=function(o){let a=this._delete_callbacks.length;Re(this._delete_callbacks,_=>_!==o),console.assert(a>this._delete_callbacks.length,'"callback" does not match a registered delete callbacks')},G.prototype.size=function(){return j(this._Table.get_id()),this._Table.size()},G.prototype.schema=function(o=!0){let a=this._Table.get_schema(),_=a.columns(),g=a.types(),y={};for(let O=0;O<_.size();O++){let P=_.get(O);P!=="psp_okey"&&(o&&this.overridden_types[P]?y[P]=this.overridden_types[P]:y[P]=kt(g.get(O).value))}return a.delete(),_.delete(),g.delete(),y};function He(o){let a=[],_={};for(let g of o){if(g.includes('""')){console.error(`Skipping expression '${g}', as it cannot reference an empty column!`);continue}let y={},O={},P=0,b,N=g.match(/^\/\/(?<alias>.+?)\n/);N?.groups?.alias&&(b=N.groups.alias.trim()),(!b||b.length==0)&&(b=g);let S=g.replace(/([a-zA-Z_]+[a-zA-Z0-9_]*)/g,q=>q=="true"?"True":q=="false"?"False":q);S=S.replace(/\"(.*?[^\\])\"/g,(q,ce)=>{if(ce=ce.replace(/\\"/g,'"'),y[ce]===void 0){let ie=`COLUMN${P}`;y[ce]=ie,O[ie]=ce}return P++,y[ce]}),S=S.replace(/'(.*?[^\\])'/g,q=>`intern(${q})`);let z=(q,ce,ie,fe)=>{let We=q.indexOf(ie);return`${q.substring(0,We)}'${fe}'${q.substring(We+ie.length)}`};S=S.replace(/(bucket|match|match_all|search|indexof)\(.*?,\s*(intern\(\'(.+)\'\)).*\)/g,z),S=S.replace(/(replace_all|replace)\(.*?,\s*(intern\(\'(.*)\'\)),.*\)/g,z);let M=[b,g,S,O];if(_[b]!==void 0){let q=_[b];a[q]=M}else a.push(M),_[b]=a.length-1}return a}G.prototype.validate_expressions=function(o,a=!0){let _={expression_schema:{},expression_alias:{},errors:{}};if(!o||o.length===0)return _;o=He(o);let g=s.make_2d_val_vector();for(let S of o){let z=s.make_val_vector();for(let M of S)z.push_back(M);g.push_back(z),_.expression_alias[S[0]]=S[1]}let y=s.validate_expressions(this._Table,g),O=y.get_expression_schema(),P=y.get_expression_errors(),b=O.keys();for(let S=0;S<b.size();S++){let z=b.get(S),M=O.get(z);a&&this.overridden_types[z]&&(M=this.overridden_types[z]),_.expression_schema[z]=M}let N=P.keys();for(let S=0;S<N.size();S++){let z=N.get(S),M=P.get(z);_.errors[z]=M}return N.delete(),b.delete(),P.delete(),O.delete(),y.delete(),_},G.prototype.is_valid_filter=function(o){if(o[1]===Ee.FILTER_OPERATORS.isNull||o[1]===Ee.FILTER_OPERATORS.isNotNull)return!0;let a=o[2];if(a===null)return!1;let _=this.schema();return _[o[0]]&&(_[o[0]]==="date"||_[o[0]]==="datetime")?s.is_valid_datetime(o[2]):typeof a!="undefined"&&a!==null},G.prototype.view=function(o={}){j(this._Table.get_id());let a={};for(let b of Object.keys(o))if(dt[b])if(!a[dt[b]])It.has(b)||(console.warn(`Deprecated: "${b}" config parameter, please use "${dt[b]}" instead`),It.add(b)),a[dt[b]]=o[b];else throw new Error(`Duplicate configuration parameter "${b}"`);else if(b==="aggregate"){It.has("aggregate")||(console.warn('Deprecated: "aggregate" config parameter has been replaced by "aggregates" and "columns"'),It.add("aggregate")),a.aggregates={},a.columns=[];for(let N of o.aggregate)a.aggregates[N.column]=N.op,a.columns.push(N.column)}else if(Zr.indexOf(b)>-1)a[b]=o[b];else throw new Error(`Unrecognized config parameter "${b}"`);a.group_by=a.group_by||[],a.split_by=a.split_by||[],a.aggregates=a.aggregates||{},a.filter=a.filter||[],a.sort=a.sort||[],a.expressions=a.expressions||[];let _=this.schema();if(a.expressions.length>0&&(a.expressions=He(a.expressions)),a.columns===void 0&&(a.columns=this.columns(),a.expressions.length>0))for(let b of a.expressions)a.columns.push(b[0]);if(a.filter.length>0)for(let b of a.filter){let N=_[b[0]];b[1]!==Ee.FILTER_OPERATORS.isNull&&b[1]!==Ee.FILTER_OPERATORS.isNotNull&&(N==="date"||N==="datetime")&&(b[2]=new Date(b[2]))}let g=Math.random()+"",y;a.group_by.length>0||a.split_by.length>0?a.split_by&&a.split_by.length>0?y=2:y=1:y=0;let O=new be(a),P=new k(this,y,a,O,g);return this.views.push(P),P};let Te;function Xe(){if(Te===void 0){let o=0,a=performance.now();setTimeout(function _(){let g=performance.now();console.log(`${(1e3*o/(g-a)).toFixed(2)} msgs/sec`),o=0,a=g,setTimeout(_,5e3)},5e3),Te=function(g){o+=g},console.log("Profiling initialized")}}G.prototype.update=function(o,a){a=a||{},a.port_id=a.port_id||0;let _,g=this.columns(),y=this._Table.get_schema(),O=y.types(),P=!1,b=!1;if(_=i,o instanceof ArrayBuffer?(_=new Uint8Array(o),P=!0):typeof o=="string"?(o[0]===","&&(o="_"+o),b=!0,P=!0,_=o):(i.init(o),i.names=g.concat(i.names.filter(N=>N==="__INDEX__")),i.types=_r(O).slice(0,g.length),Te&&Te(i.row_count)),!P){if(_.row_count===0){console.warn("table.update called with no data - ignoring");return}i.names.indexOf("__INDEX__")!=-1&&(!!this.index?i.types.push(i.types[i.names.indexOf(this.index)]):i.types.push(s.t_dtype.DTYPE_INT32))}try{let N=s.t_op.OP_INSERT;de(_,this._Table,this.index,this.limit,N,!0,P,b,a.port_id).delete(),this.initialized=!0}catch(N){console.error(`Update failed: ${N}`)}finally{y.delete()}},G.prototype.remove=function(o,a){if(!this.index){console.error("Cannot call `remove()` on a Table without a user-specified index.");return}a=a||{},a.port_id=a.port_id||0;let _,g=this.columns(),y=this._Table.get_schema(),O=y.types(),P=!1;o=o.map(b=>({[this.index]:b})),o instanceof ArrayBuffer?(_=new Uint8Array(o),P=!0):(i.init(o),i.names=[this.index],i.types=[_r(O)[g.indexOf(this.index)]],_=i);try{let b=s.t_op.OP_DELETE;de(_,this._Table,this.index,this.limit,b,!1,P,!1,a.port_id).delete(),this.initialized=!0}catch(b){console.error("Remove failed",b)}finally{y.delete()}},G.prototype.columns=function(){let o=this._Table.get_schema(),a=o.columns(),_=[];for(let g=0;g<a.size();g++){let y=a.get(g);y!=="psp_okey"&&_.push(y)}return o.delete(),a.delete(),_},G.prototype.execute=function(o){o(this)};let Ee={__module__:s,Server:Ft,worker:function(){return this},initialize_profile_thread:Xe,memory_usage:J,table:function(o,a){a=a||{},a.index=a.index||null,a.limit=a.limit||null;let _,g=!1,y={},O=!1;if(o instanceof ArrayBuffer||typeof Buffer!="undefined"&&o instanceof Buffer?(_=new Uint8Array(o),g=!0):typeof o=="string"?(o[0]===","&&(o="_"+o),O=!0,g=!0,_=o):(i.clean(),y=i.init(o),_=i),a.index&&a.limit)throw`Cannot specify both index '${a.index}' and limit '${a.limit}'.`;let P;try{let b=s.t_op.OP_INSERT;return P=de(_,void 0,a.index,a.limit,b,!1,g,O,0),new G(P,a.index,a.limit,y)}catch(b){throw P&&P.delete(),console.error(`Table initialization failed: ${b}`),b}}};for(let o of Object.keys(Rt))Ee[o]=Rt[o];class Ce extends Ft{constructor(a){super(a);self.addEventListener("message",_=>this.process(_.data),!1)}post(a,_){self.postMessage(a,_)}init(a){if(typeof WebAssembly=="undefined")throw new Error("WebAssembly not supported");s({wasmBinary:a.buffer,wasmJSMethod:"native-wasm"}).then(_=>{s=_,s.init(),ho(),super.init(a)})}}return typeof self!="undefined"&&self.addEventListener&&new Ce(Ee),Ee}function ho(){if(typeof self!="undefined")try{if(self.dispatchEvent&&!self._perspective_initialized&&self.document!==null){self._perspective_initialized=!0;let h=self.document.createEvent("Event");h.initEvent("perspective-ready",!1,!0),self.dispatchEvent(h)}else!self.document&&self.postMessage&&self.postMessage({})}catch{}}var Uo=globalThis.perspective=an(Xr);})();
