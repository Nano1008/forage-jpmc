{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\95841\\\\Desktop\\\\forage-jpmc-swe-task-3\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\95841\\\\Desktop\\\\forage-jpmc-swe-task-3\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\95841\\\\Desktop\\\\forage-jpmc-swe-task-3\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\95841\\\\Desktop\\\\forage-jpmc-swe-task-3\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\95841\\\\Desktop\\\\forage-jpmc-swe-task-3\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport React, { Component } from \"react\";\nimport { DataManipulator } from \"./DataManipulator\";\nimport \"./Graph.css\";\n\nvar Graph = /*#__PURE__*/function (_Component) {\n  _inherits(Graph, _Component);\n\n  function Graph() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Graph);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Graph)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.table = void 0;\n    return _this;\n  }\n\n  _createClass(Graph, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"perspective-viewer\");\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      // Get element from the DOM.\n      var elem = document.getElementsByTagName(\"perspective-viewer\")[0];\n      var schema = {\n        price_abc: \"float\",\n        price_def: \"float\",\n        ratio: \"float\",\n        upper_bound: \"float\",\n        lower_bound: \"float\",\n        trigger_alert: \"float\",\n        timestamp: \"date\"\n      };\n\n      if (window.perspective && window.perspective.worker()) {\n        this.table = window.perspective.worker().table(schema);\n      }\n\n      if (this.table) {\n        // Load the `table` in the `<perspective-viewer>` DOM reference.\n        elem.load(this.table);\n        elem.setAttribute(\"view\", \"y_line\");\n        elem.setAttribute(\"row-pivots\", '[\"timestamp\"]');\n        elem.setAttribute(\"columns\", '[\"ratio\", \"upper_bound\", \"lower_bound\", \"trigger_alert\"]');\n        elem.setAttribute(\"aggregates\", JSON.stringify({\n          price_abc: \"avg\",\n          price_def: \"avg\",\n          ratio: \"avg\",\n          upper_bound: \"avg\",\n          lower_bound: \"avg\",\n          trigger_alert: \"avg\",\n          timestamp: \"distinct count\"\n        }));\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      if (this.table) {\n        this.table.update([DataManipulator.generateRow(this.props.data)]);\n      }\n    }\n  }]);\n\n  return Graph;\n}(Component);\n\nexport default Graph;","map":{"version":3,"names":["React","Component","DataManipulator","Graph","table","createElement","elem","document","getElementsByTagName","schema","price_abc","price_def","ratio","upper_bound","lower_bound","trigger_alert","timestamp","window","perspective","worker","load","setAttribute","JSON","stringify","update","generateRow","props","data"],"sources":["C:/Users/95841/Desktop/forage-jpmc-swe-task-3/src/Graph.tsx"],"sourcesContent":["import React, { Component } from \"react\";\r\nimport { Table, TableData } from \"@finos/perspective\";\r\nimport { ServerRespond } from \"./DataStreamer\";\r\nimport { DataManipulator } from \"./DataManipulator\";\r\nimport \"./Graph.css\";\r\n\r\ninterface IProps {\r\n  data: ServerRespond[];\r\n}\r\n\r\ninterface PerspectiveViewerElement extends HTMLElement {\r\n  load: (table: Table) => void;\r\n}\r\nclass Graph extends Component<IProps, {}> {\r\n  table: Table | undefined;\r\n\r\n  render() {\r\n    return React.createElement(\"perspective-viewer\");\r\n  }\r\n\r\n  componentDidMount() {\r\n    // Get element from the DOM.\r\n    const elem = (document.getElementsByTagName(\r\n      \"perspective-viewer\"\r\n    )[0] as unknown) as PerspectiveViewerElement;\r\n\r\n    const schema = {\r\n      price_abc: \"float\",\r\n      price_def: \"float\",\r\n      ratio: \"float\",\r\n      upper_bound: \"float\",\r\n      lower_bound: \"float\",\r\n      trigger_alert: \"float\",\r\n      timestamp: \"date\",\r\n    };\r\n\r\n    if (window.perspective && window.perspective.worker()) {\r\n      this.table = window.perspective.worker().table(schema);\r\n    }\r\n    if (this.table) {\r\n      // Load the `table` in the `<perspective-viewer>` DOM reference.\r\n      elem.load(this.table);\r\n      elem.setAttribute(\"view\", \"y_line\");\r\n      elem.setAttribute(\"row-pivots\", '[\"timestamp\"]');\r\n      elem.setAttribute(\r\n        \"columns\",\r\n        '[\"ratio\", \"upper_bound\", \"lower_bound\", \"trigger_alert\"]'\r\n      );\r\n      elem.setAttribute(\r\n        \"aggregates\",\r\n        JSON.stringify({\r\n          price_abc: \"avg\",\r\n          price_def: \"avg\",\r\n          ratio: \"avg\",\r\n          upper_bound: \"avg\",\r\n          lower_bound: \"avg\",\r\n          trigger_alert: \"avg\",\r\n          timestamp: \"distinct count\",\r\n        })\r\n      );\r\n    }\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    if (this.table) {\r\n      this.table.update(([\r\n        DataManipulator.generateRow(this.props.data),\r\n      ] as unknown) as TableData);\r\n    }\r\n  }\r\n}\r\n\r\nexport default Graph;\r\n"],"mappings":";;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AAGA,SAASC,eAAT,QAAgC,mBAAhC;AACA,OAAO,aAAP;;IASMC,K;;;;;;;;;;;;;;;UACJC,K;;;;;;6BAES;MACP,OAAOJ,KAAK,CAACK,aAAN,CAAoB,oBAApB,CAAP;IACD;;;wCAEmB;MAClB;MACA,IAAMC,IAAI,GAAIC,QAAQ,CAACC,oBAAT,CACZ,oBADY,EAEZ,CAFY,CAAd;MAIA,IAAMC,MAAM,GAAG;QACbC,SAAS,EAAE,OADE;QAEbC,SAAS,EAAE,OAFE;QAGbC,KAAK,EAAE,OAHM;QAIbC,WAAW,EAAE,OAJA;QAKbC,WAAW,EAAE,OALA;QAMbC,aAAa,EAAE,OANF;QAObC,SAAS,EAAE;MAPE,CAAf;;MAUA,IAAIC,MAAM,CAACC,WAAP,IAAsBD,MAAM,CAACC,WAAP,CAAmBC,MAAnB,EAA1B,EAAuD;QACrD,KAAKf,KAAL,GAAaa,MAAM,CAACC,WAAP,CAAmBC,MAAnB,GAA4Bf,KAA5B,CAAkCK,MAAlC,CAAb;MACD;;MACD,IAAI,KAAKL,KAAT,EAAgB;QACd;QACAE,IAAI,CAACc,IAAL,CAAU,KAAKhB,KAAf;QACAE,IAAI,CAACe,YAAL,CAAkB,MAAlB,EAA0B,QAA1B;QACAf,IAAI,CAACe,YAAL,CAAkB,YAAlB,EAAgC,eAAhC;QACAf,IAAI,CAACe,YAAL,CACE,SADF,EAEE,0DAFF;QAIAf,IAAI,CAACe,YAAL,CACE,YADF,EAEEC,IAAI,CAACC,SAAL,CAAe;UACbb,SAAS,EAAE,KADE;UAEbC,SAAS,EAAE,KAFE;UAGbC,KAAK,EAAE,KAHM;UAIbC,WAAW,EAAE,KAJA;UAKbC,WAAW,EAAE,KALA;UAMbC,aAAa,EAAE,KANF;UAObC,SAAS,EAAE;QAPE,CAAf,CAFF;MAYD;IACF;;;yCAEoB;MACnB,IAAI,KAAKZ,KAAT,EAAgB;QACd,KAAKA,KAAL,CAAWoB,MAAX,CAAmB,CACjBtB,eAAe,CAACuB,WAAhB,CAA4B,KAAKC,KAAL,CAAWC,IAAvC,CADiB,CAAnB;MAGD;IACF;;;;EAxDiB1B,S;;AA2DpB,eAAeE,KAAf"},"metadata":{},"sourceType":"module"}